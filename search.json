[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "about ãƒšãƒ¼ã‚¸ã§ã™\n\n\nCopyrightCopyright tamuraup. 2024. All Rights Reserved"
  },
  {
    "objectID": "archives/2024-05-01-chokudaisearch.html",
    "href": "archives/2024-05-01-chokudaisearch.html",
    "title": "chokudai search template",
    "section": "",
    "text": "chokudai search ã®ç·´ç¿’ã‚’ã—ãŸã®ã§ãƒ¡ãƒ¢ã€‚\n#[derive(PartialEq, Eq, Clone)]\nstruct State {\n    score: i64,\n}\nimpl State {\n    fn new() -&gt; Self {\n        todo!()\n    }\n}\n\nimpl Ord for State {\n    fn cmp(&self, other: &Self) -&gt; Ordering {\n        self.score.cmp(&other.score)\n    }\n}\n\nimpl PartialOrd for State {\n    fn partial_cmp(&self, other: &Self) -&gt; Option&lt;Ordering&gt; {\n        Some(self.cmp(other))\n    }\n}\n\nfn simple_chokudai_search(inp: &Input, timer: &Timer) {\n    let mut beams: Vec&lt;LimitedMaximumHeap&lt;State&gt;&gt; = vec![LimitedMaximumHeap::new(500); 51];\n\n    let mut iter = 0;\n    let mut best = 0;\n    beams[0].push(State::new());\n\n    'outer: loop {\n        iter += 1;\n        if timer.t() &gt;= 1.0 {\n            break;\n        }\n\n        for depth in 0..beams.len() {\n            if depth % 10 == 0 && timer.t() &gt;= 1.0 {\n                break 'outer;\n            }\n            if beams[depth].is_empty() {\n                continue;\n            }\n            // ã“ã“ã§è¤‡æ•°å› pop ã™ã‚‹ã¨ å¹… &gt; 1 ã£ã¦ã“ã¨ï¼Ÿ\n            let state = beams[depth].pop().unwrap();\n            // TODO: ãªã«ã‹å‡¦ç†\n        }\n    }\n}\n\n\n\nCopyrightCopyright tamuraup. 2024. All Rights Reserved"
  },
  {
    "objectID": "posts/2024-05-03_ahc032memo.html",
    "href": "posts/2024-05-03_ahc032memo.html",
    "title": "AHC032 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "",
    "text": "è§£èª¬æ”¾é€ã¿ãŸãƒ¡ãƒ¢"
  },
  {
    "objectID": "posts/2024-05-03_ahc032memo.html#è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "href": "posts/2024-05-03_ahc032memo.html#è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "title": "AHC032 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "text": "è§£èª¬æ”¾é€ãƒ¡ãƒ¢\n\nè§£èª¬æ”¾é€: https://www.youtube.com/watch?v=9JS0wXXNiZk\neijirou ã•ã‚“è§£æ³•: https://atcoder.jp/contests/ahc032/submissions?f.User=eijirou\nwata ã•ã‚“è§£æ³•: https://atcoder.jp/contests/ahc032/submissions/52151408"
  },
  {
    "objectID": "posts/2024-05-03_ahc032memo.html#è€ƒå¯Ÿ",
    "href": "posts/2024-05-03_ahc032memo.html#è€ƒå¯Ÿ",
    "title": "AHC032 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "è€ƒå¯Ÿ",
    "text": "è€ƒå¯Ÿ\n\n3*3 ã®ãƒã‚¹ã‚’ã™ã¹ã¦ MOD*0.8 ä»¥ä¸Šã«ã™ã‚‹ãŸã‚ã«ã¯ 5^9 é€šã‚Šå€™è£œãŒã»ã—ã„\n\n(ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸ãˆã‚‰ã‚ŒãŸã‚¹ã‚¿ãƒ³ãƒ—ã§ 1 ãƒã‚¹ã‚’ MOD*4/5 ä»¥ä¸Šã«ã§ãã‚‹ç¢ºç‡ 1/5)\n\nè¿‘å‚ãŒãªã‚ã‚‰ã‹ã§ãªã„ã®ã§ã€ç„¼ããªã¾ã—ãªã©ã®å±€æ‰€æ¢ç´¢ã¯ä¸é©\nåŒã˜ 9 ãƒã‚¹ã‚’æ“ä½œã™ã‚‹ãªã‚‰ã€å·¦ä¸Šã®ç‚¹ã¯åˆ†æ•£ã•ã›ãŸã»ã†ãŒå ´åˆã®æ•°ãŒå¢—ãˆã‚‹"
  },
  {
    "objectID": "posts/2024-05-03_ahc032memo.html#ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒ",
    "href": "posts/2024-05-03_ahc032memo.html#ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒ",
    "title": "AHC032 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒ",
    "text": "ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒ\n\nè©•ä¾¡é–¢æ•°: \\(ç¢ºå®šã‚¹ã‚³ã‚¢ + K * MOD * (1 - é€²è¡Œåº¦) * æ®‹ã‚Šã®æ“ä½œå›æ•°\\) (\\(K\\) ã¯ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿)\n\né€²è¡Œåº¦ãŒå°ã•ã„å ´åˆã¯ã€å¾Œã§ã‚ˆã‚Šä¸Šæ‰‹ãæƒãˆã‚‰ã‚Œã‚‹ã‚ˆã†ã«æ“ä½œå›æ•°ã‚’æ®‹ã—ãŸã„\n\n\n\nã€Œæ“ä½œå›æ•°åˆ¥ã§ãƒ“ãƒ¼ãƒ ã‚’åˆ†ã‘ã‚‹ã€ã¨ã¯\nwata ã•ã‚“ã®å®Ÿè£…ã§ã¯æ“ä½œå›æ•°åˆ¥ã§ãƒ“ãƒ¼ãƒ ã‚’åˆ†ã‘ã¦ã„ã‚‹ã€‚\nã“ã“ã§ã„ã†ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒã¯å¹…å„ªå…ˆã®ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒã§ã€Œç¢ºå®šãƒã‚¹æ•°ã€ãŒæ·±ã•ã«å¯¾å¿œã™ã‚‹ã€‚\nç¢ºå®šãƒã‚¹æ•°ã‚’ C ã¨ã™ã‚‹ã€‚ã“ã‚Œã‚’æ“ä½œå›æ•°ã®åŸºæº–ã¨ã—ã¦ \\(\\pm W\\) å›ã®æ“ä½œå›æ•°ã®ã‚ºãƒ¬ã‚’è¨±å®¹ã—ã€ãã®ã‚ºãƒ¬å¹…ã”ã¨ã«ãƒ“ãƒ¼ãƒ ã‚’ã‚‚ã¤ã€‚\n(ä¾‹: ã‚³ãƒ¼ãƒ‰ã® beam[W] ã¯ã‚ºãƒ¬å¹… 0 ã®ãƒ“ãƒ¼ãƒ )\n\n\næƒãˆã‚‹ãƒã‚¹ã®é †\n35:30\n\næƒãˆã‚‹é †åºã¯ 3 ãƒã‚¹æƒãˆãŒé€£ç¶šã—ãªã„ã»ã†ãŒè‰¯ã„\nãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒã®ã€Œç¢ºå®šã‚¹ã‚³ã‚¢/ç¢ºå®šãƒã‚¹æ•°ã€ã‚’å¯è¦–åŒ–ã™ã‚‹ã“ã¨ã§ç¢ºèªã—ã¦ã„ã‚‹"
  },
  {
    "objectID": "posts/2024-05-03_ahc032memo.html#é«˜é€ŸåŒ–",
    "href": "posts/2024-05-03_ahc032memo.html#é«˜é€ŸåŒ–",
    "title": "AHC032 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "é«˜é€ŸåŒ–",
    "text": "é«˜é€ŸåŒ–\n\nä¸è¦ãªã‚¹ã‚¿ãƒ³ãƒ—ã‚’ã§ãã‚‹ã ã‘æ¸›ã‚‰ã™å·¥å¤«ã‚’ã—ã¦ã„ã‚‹\nã‚¹ã‚¿ãƒ³ãƒ—ã‚’å³ä¸Šã®å€¤ã§åˆ†é¡ã—ã€å³ä¸Šãƒã‚¹ã‚’è‰¯ã„å€¤ã«ã§ãã‚‹ã‚¹ã‚¿ãƒ³ãƒ—ã®å€™è£œã‚’çµã‚Šè¾¼ã‚ã‚‹ã‚ˆã†ã«ã™ã‚‹ãªã©\n\n\nK åˆ†æœ¨ã®è©±\nwata ã•ã‚“å®Ÿè£…ã® Searcher ãŒãã‚Œã€‚\nã‚„ã‚‹ã“ã¨ã¯ã€Œ3ãƒã‚¹æƒãˆã€ã§è©±ã—ã¦ã„ã‚‹ã“ã¨ã¨ã»ã¨ã‚“ã©åŒã˜ã€‚\nMOD ã‚’ K å€‹ã®åŒºé–“ã«åˆ†ã‘ã¦ã€ã‚¹ã‚¿ãƒ³ãƒ—ã® 1 ãƒã‚¹ç›®ã®å€¤ã§ K åˆ†å‰²ã€2 ãƒã‚¹ç›®ã®å€¤ã§ K åˆ†å‰² â€¦\nã®ã‚ˆã†ã«åˆ†å‰²ã™ã‚‹ã€æœ¨ã®æ·±ã•ãŒ i ãƒã‚¹ç›®ã®åˆ†å‰²ã¨ãªã‚‹ K åˆ†æœ¨ã‚’ä½œã‚Šã€è‰¯ã„ã‚¹ã‚¿ãƒ³ãƒ—ã®æ¢ç´¢ã‚’é«˜é€Ÿã«ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚"
  },
  {
    "objectID": "posts/2025-06-15_upsampling.html",
    "href": "posts/2025-06-15_upsampling.html",
    "title": "ã‚¢ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚° + ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°å‡¦ç†ã®æµã‚Œ",
    "section": "",
    "text": "3æ¬¡å…ƒã® NumPy ãƒ†ãƒ³ã‚½ãƒ« xï¼ˆå½¢çŠ¶: (B, T, C)ï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚\nã“ã“ã§ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ã£ã¦ä¸­èº«ã‚’å¯è¦–åŒ–ã—ã‚„ã™ãã—ã¦ã„ã¾ã™ã€‚\n\n\n\n\nx[:, :, None, :].repeat(1, 1, ratio, 1) ã«ã‚ˆã£ã¦ã€æ™‚é–“è»¸ã®å„ã‚¹ãƒ†ãƒƒãƒ—ã‚’ ratio å€ã«æ‹¡å¼µã—ã¾ã™ã€‚\n\nx[:, :, None, :] â†’ æ¬¡å…ƒã‚’è¿½åŠ ã—ã¦ (B, T, 1, C)\n.repeat(...) â†’ (B, T, ratio, C) ã«æ‹¡å¼µ\n.reshape(B, T * ratio, C) â†’ æ™‚é–“è»¸ã‚’1æœ¬åŒ–\n\nçµæœã€æ™‚é–“æ–¹å‘ã« T * ratio é•·ã®ãƒ†ãƒ³ã‚½ãƒ«ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚\n\n\n\n\næŒ‡å®šã®é•·ã• frame_size ã«æº€ãŸãªã„å ´åˆã€æœ€å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ã®å€¤ã‚’è¤‡è£½ã—ã¦è£œã„ã¾ã™ã€‚\n\ny[:, -1:, :] ã§æœ€å¾Œã®ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’å–ã‚Šå‡ºã—\n.repeat(...) ã§å¿…è¦æ•°ã ã‘ç¹°ã‚Šè¿”ã—\ntorch.cat([y, padding], dim=1) ã§çµåˆ\n\né•·ã•ãŒã™ã§ã« frame_size ä»¥ä¸Šãªã‚‰ã€å…ˆé ­ã‹ã‚‰ frame_size åˆ†ã ã‘ã‚’åˆ‡ã‚Šå‡ºã—ã¾ã™ã€‚\n\n\n\n\nã“ã®å‡¦ç†ã§ã€ä»»æ„ã®å…¥åŠ›ãƒ†ãƒ³ã‚½ãƒ«ã‚’ï¼š\n\næŒ‡å®šã®æ™‚é–“é•· (frame_size) ã«çµ±ä¸€\næ»‘ã‚‰ã‹ã«æ‹¡å¼µã—ã¤ã¤ã€ç«¯ã¯è‡ªç„¶ã«è£œå®Œ\n\nã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\nç”¨é€”ã®ä¾‹: - éŸ³å£°ã‚„å‹•ç”»ã®æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿æ•´å½¢ - Transformer ç³»ã¸ã®å…¥åŠ›å‰ã®æ•´å½¢ - ãƒ©ãƒ™ãƒ«ä»˜ããƒ‡ãƒ¼ã‚¿ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆè£œæ­£\n\n\nimport numpy as np\nimport torch\n\n\n# ã‚»ãƒ« 2: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨å…ƒãƒ‡ãƒ¼ã‚¿ä½œæˆ\nB, T, C = 2, 3, 4  # ãƒãƒƒãƒã‚µã‚¤ã‚ºã€æ™‚é–“é•·ã€ãƒãƒ£ãƒãƒ«æ•°\nratio = 3         # ã‚¢ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°å€ç‡\nframe_size = 11          # æœ€çµ‚çš„ãªé•·ã•ã«ã—ãŸã„ã‚µã‚¤ã‚º\n\n# è¦‹ã‚„ã™ã„ã‚ˆã†ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ããƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ\nx = torch.arange(B * T * C).reshape(B, T, C)\nprint(\"å…ƒã®xã® shape:\", x.shape)\nprint(x)\n\nå…ƒã®xã® shape: torch.Size([2, 3, 4])\ntensor([[[ 0,  1,  2,  3],\n         [ 4,  5,  6,  7],\n         [ 8,  9, 10, 11]],\n\n        [[12, 13, 14, 15],\n         [16, 17, 18, 19],\n         [20, 21, 22, 23]]])\n\n\n\n# ã‚»ãƒ« 3: ratio å€ã«æ‹¡å¼µï¼ˆã‚¢ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ï¼‰\nx_expanded = x[:, :, None, :].repeat(1, 1, ratio, 1)\nprint(\"æ‹¡å¼µå¾Œã® shape:\", x_expanded.shape)\nprint(x_expanded)\n\næ‹¡å¼µå¾Œã® shape: torch.Size([2, 3, 3, 4])\ntensor([[[[ 0,  1,  2,  3],\n          [ 0,  1,  2,  3],\n          [ 0,  1,  2,  3]],\n\n         [[ 4,  5,  6,  7],\n          [ 4,  5,  6,  7],\n          [ 4,  5,  6,  7]],\n\n         [[ 8,  9, 10, 11],\n          [ 8,  9, 10, 11],\n          [ 8,  9, 10, 11]]],\n\n\n        [[[12, 13, 14, 15],\n          [12, 13, 14, 15],\n          [12, 13, 14, 15]],\n\n         [[16, 17, 18, 19],\n          [16, 17, 18, 19],\n          [16, 17, 18, 19]],\n\n         [[20, 21, 22, 23],\n          [20, 21, 22, 23],\n          [20, 21, 22, 23]]]])\n\n\n\n# ã‚»ãƒ« 4: reshape ã—ã¦æ™‚é–“æ–¹å‘ã‚’1æœ¬åŒ–\nx_reshaped = x_expanded.reshape(B, T * ratio, C)\nprint(\"reshapeå¾Œã® shape:\", x_reshaped.shape)\nprint(x_reshaped)\n\nreshapeå¾Œã® shape: torch.Size([2, 9, 4])\ntensor([[[ 0,  1,  2,  3],\n         [ 0,  1,  2,  3],\n         [ 0,  1,  2,  3],\n         [ 4,  5,  6,  7],\n         [ 4,  5,  6,  7],\n         [ 4,  5,  6,  7],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11]],\n\n        [[12, 13, 14, 15],\n         [12, 13, 14, 15],\n         [12, 13, 14, 15],\n         [16, 17, 18, 19],\n         [16, 17, 18, 19],\n         [16, 17, 18, 19],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23]]])\n\n\n\n# ã‚»ãƒ« 5: PyTorchãƒ†ãƒ³ã‚½ãƒ«ã«å¤‰æ›ã—ã¦ padding å‡¦ç†\ny = x_reshaped\n\n# è¶³ã‚Šãªã„é•·ã•ã‚’è£œã†ï¼ˆæœ€å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¤‡è£½ï¼‰\nif y.shape[1] &lt; frame_size:\n    padding = y[:, -1:, :].repeat(1, frame_size - y.shape[1], 1)\n    y_padded = torch.cat([y, padding], dim=1)\nelse:\n    y_padded = y[:, :frame_size, :]  # ã‚‚ã—é•·ã™ããŸã‚‰åˆ‡ã‚Šè©°ã‚ã‚‹\n\nprint(\"æœ€çµ‚ y_padded ã® shape:\", y_padded.shape)\nprint(y_padded)\n\næœ€çµ‚ y_padded ã® shape: torch.Size([2, 11, 4])\ntensor([[[ 0,  1,  2,  3],\n         [ 0,  1,  2,  3],\n         [ 0,  1,  2,  3],\n         [ 4,  5,  6,  7],\n         [ 4,  5,  6,  7],\n         [ 4,  5,  6,  7],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11]],\n\n        [[12, 13, 14, 15],\n         [12, 13, 14, 15],\n         [12, 13, 14, 15],\n         [16, 17, 18, 19],\n         [16, 17, 18, 19],\n         [16, 17, 18, 19],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23]]])"
  },
  {
    "objectID": "posts/2025-06-15_upsampling.html#ã‚¢ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°-ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°å‡¦ç†ã®æµã‚Œ",
    "href": "posts/2025-06-15_upsampling.html#ã‚¢ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°-ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°å‡¦ç†ã®æµã‚Œ",
    "title": "ã‚¢ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚° + ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°å‡¦ç†ã®æµã‚Œ",
    "section": "",
    "text": "3æ¬¡å…ƒã® NumPy ãƒ†ãƒ³ã‚½ãƒ« xï¼ˆå½¢çŠ¶: (B, T, C)ï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚\nã“ã“ã§ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ã£ã¦ä¸­èº«ã‚’å¯è¦–åŒ–ã—ã‚„ã™ãã—ã¦ã„ã¾ã™ã€‚\n\n\n\n\nx[:, :, None, :].repeat(1, 1, ratio, 1) ã«ã‚ˆã£ã¦ã€æ™‚é–“è»¸ã®å„ã‚¹ãƒ†ãƒƒãƒ—ã‚’ ratio å€ã«æ‹¡å¼µã—ã¾ã™ã€‚\n\nx[:, :, None, :] â†’ æ¬¡å…ƒã‚’è¿½åŠ ã—ã¦ (B, T, 1, C)\n.repeat(...) â†’ (B, T, ratio, C) ã«æ‹¡å¼µ\n.reshape(B, T * ratio, C) â†’ æ™‚é–“è»¸ã‚’1æœ¬åŒ–\n\nçµæœã€æ™‚é–“æ–¹å‘ã« T * ratio é•·ã®ãƒ†ãƒ³ã‚½ãƒ«ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚\n\n\n\n\næŒ‡å®šã®é•·ã• frame_size ã«æº€ãŸãªã„å ´åˆã€æœ€å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ã®å€¤ã‚’è¤‡è£½ã—ã¦è£œã„ã¾ã™ã€‚\n\ny[:, -1:, :] ã§æœ€å¾Œã®ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’å–ã‚Šå‡ºã—\n.repeat(...) ã§å¿…è¦æ•°ã ã‘ç¹°ã‚Šè¿”ã—\ntorch.cat([y, padding], dim=1) ã§çµåˆ\n\né•·ã•ãŒã™ã§ã« frame_size ä»¥ä¸Šãªã‚‰ã€å…ˆé ­ã‹ã‚‰ frame_size åˆ†ã ã‘ã‚’åˆ‡ã‚Šå‡ºã—ã¾ã™ã€‚\n\n\n\n\nã“ã®å‡¦ç†ã§ã€ä»»æ„ã®å…¥åŠ›ãƒ†ãƒ³ã‚½ãƒ«ã‚’ï¼š\n\næŒ‡å®šã®æ™‚é–“é•· (frame_size) ã«çµ±ä¸€\næ»‘ã‚‰ã‹ã«æ‹¡å¼µã—ã¤ã¤ã€ç«¯ã¯è‡ªç„¶ã«è£œå®Œ\n\nã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\nç”¨é€”ã®ä¾‹: - éŸ³å£°ã‚„å‹•ç”»ã®æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿æ•´å½¢ - Transformer ç³»ã¸ã®å…¥åŠ›å‰ã®æ•´å½¢ - ãƒ©ãƒ™ãƒ«ä»˜ããƒ‡ãƒ¼ã‚¿ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆè£œæ­£\n\n\nimport numpy as np\nimport torch\n\n\n# ã‚»ãƒ« 2: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨å…ƒãƒ‡ãƒ¼ã‚¿ä½œæˆ\nB, T, C = 2, 3, 4  # ãƒãƒƒãƒã‚µã‚¤ã‚ºã€æ™‚é–“é•·ã€ãƒãƒ£ãƒãƒ«æ•°\nratio = 3         # ã‚¢ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°å€ç‡\nframe_size = 11          # æœ€çµ‚çš„ãªé•·ã•ã«ã—ãŸã„ã‚µã‚¤ã‚º\n\n# è¦‹ã‚„ã™ã„ã‚ˆã†ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ããƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ\nx = torch.arange(B * T * C).reshape(B, T, C)\nprint(\"å…ƒã®xã® shape:\", x.shape)\nprint(x)\n\nå…ƒã®xã® shape: torch.Size([2, 3, 4])\ntensor([[[ 0,  1,  2,  3],\n         [ 4,  5,  6,  7],\n         [ 8,  9, 10, 11]],\n\n        [[12, 13, 14, 15],\n         [16, 17, 18, 19],\n         [20, 21, 22, 23]]])\n\n\n\n# ã‚»ãƒ« 3: ratio å€ã«æ‹¡å¼µï¼ˆã‚¢ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ï¼‰\nx_expanded = x[:, :, None, :].repeat(1, 1, ratio, 1)\nprint(\"æ‹¡å¼µå¾Œã® shape:\", x_expanded.shape)\nprint(x_expanded)\n\næ‹¡å¼µå¾Œã® shape: torch.Size([2, 3, 3, 4])\ntensor([[[[ 0,  1,  2,  3],\n          [ 0,  1,  2,  3],\n          [ 0,  1,  2,  3]],\n\n         [[ 4,  5,  6,  7],\n          [ 4,  5,  6,  7],\n          [ 4,  5,  6,  7]],\n\n         [[ 8,  9, 10, 11],\n          [ 8,  9, 10, 11],\n          [ 8,  9, 10, 11]]],\n\n\n        [[[12, 13, 14, 15],\n          [12, 13, 14, 15],\n          [12, 13, 14, 15]],\n\n         [[16, 17, 18, 19],\n          [16, 17, 18, 19],\n          [16, 17, 18, 19]],\n\n         [[20, 21, 22, 23],\n          [20, 21, 22, 23],\n          [20, 21, 22, 23]]]])\n\n\n\n# ã‚»ãƒ« 4: reshape ã—ã¦æ™‚é–“æ–¹å‘ã‚’1æœ¬åŒ–\nx_reshaped = x_expanded.reshape(B, T * ratio, C)\nprint(\"reshapeå¾Œã® shape:\", x_reshaped.shape)\nprint(x_reshaped)\n\nreshapeå¾Œã® shape: torch.Size([2, 9, 4])\ntensor([[[ 0,  1,  2,  3],\n         [ 0,  1,  2,  3],\n         [ 0,  1,  2,  3],\n         [ 4,  5,  6,  7],\n         [ 4,  5,  6,  7],\n         [ 4,  5,  6,  7],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11]],\n\n        [[12, 13, 14, 15],\n         [12, 13, 14, 15],\n         [12, 13, 14, 15],\n         [16, 17, 18, 19],\n         [16, 17, 18, 19],\n         [16, 17, 18, 19],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23]]])\n\n\n\n# ã‚»ãƒ« 5: PyTorchãƒ†ãƒ³ã‚½ãƒ«ã«å¤‰æ›ã—ã¦ padding å‡¦ç†\ny = x_reshaped\n\n# è¶³ã‚Šãªã„é•·ã•ã‚’è£œã†ï¼ˆæœ€å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¤‡è£½ï¼‰\nif y.shape[1] &lt; frame_size:\n    padding = y[:, -1:, :].repeat(1, frame_size - y.shape[1], 1)\n    y_padded = torch.cat([y, padding], dim=1)\nelse:\n    y_padded = y[:, :frame_size, :]  # ã‚‚ã—é•·ã™ããŸã‚‰åˆ‡ã‚Šè©°ã‚ã‚‹\n\nprint(\"æœ€çµ‚ y_padded ã® shape:\", y_padded.shape)\nprint(y_padded)\n\næœ€çµ‚ y_padded ã® shape: torch.Size([2, 11, 4])\ntensor([[[ 0,  1,  2,  3],\n         [ 0,  1,  2,  3],\n         [ 0,  1,  2,  3],\n         [ 4,  5,  6,  7],\n         [ 4,  5,  6,  7],\n         [ 4,  5,  6,  7],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11],\n         [ 8,  9, 10, 11]],\n\n        [[12, 13, 14, 15],\n         [12, 13, 14, 15],\n         [12, 13, 14, 15],\n         [16, 17, 18, 19],\n         [16, 17, 18, 19],\n         [16, 17, 18, 19],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23],\n         [20, 21, 22, 23]]])"
  },
  {
    "objectID": "posts/2025-06-15_AUCLoss.html",
    "href": "posts/2025-06-15_AUCLoss.html",
    "title": "AUCLoss ã«é–¢ã™ã‚‹è§£èª¬ãƒ¬ãƒãƒ¼ãƒˆ",
    "section": "",
    "text": "Note\n\n\n\næœ¬ãƒ¬ãƒãƒ¼ãƒˆã¯ã€OpenAI ã®å¯¾è©±å‹ AI ChatGPT ã«ã‚ˆã‚Šç”Ÿæˆãƒ»æ•´ç†ã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚"
  },
  {
    "objectID": "posts/2025-06-15_AUCLoss.html#æ¦‚è¦",
    "href": "posts/2025-06-15_AUCLoss.html#æ¦‚è¦",
    "title": "AUCLoss ã«é–¢ã™ã‚‹è§£èª¬ãƒ¬ãƒãƒ¼ãƒˆ",
    "section": "æ¦‚è¦",
    "text": "æ¦‚è¦\nã“ã®ãƒ¬ãƒãƒ¼ãƒˆã§ã¯ã€Kaggle ã® BirdCLEF 2025 ã‚³ãƒ³ãƒšãƒ†ã‚£ã‚·ãƒ§ãƒ³ã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³\nï¼ˆãƒªãƒ³ã‚¯ã¯ã“ã¡ã‚‰ï¼‰ã§å…±æœ‰ã•ã‚Œã¦ã„ãŸ AUCLoss ã‚¯ãƒ©ã‚¹ã«ã¤ã„ã¦ã®ç†è§£ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚\nã“ã®ã‚«ã‚¹ã‚¿ãƒ æå¤±é–¢æ•°ã¯ã€AUCï¼ˆArea Under the Curveï¼‰ã‚’æœ€å¤§åŒ–ã™ã‚‹ç›®çš„ã§è¨­è¨ˆã•ã‚ŒãŸãƒšã‚¢ãƒ¯ã‚¤ã‚ºãƒ­ã‚¹ã§ã™ã€‚"
  },
  {
    "objectID": "posts/2025-06-15_AUCLoss.html#aucloss-ã®ã‚³ãƒ¼ãƒ‰ã¨ç›®çš„",
    "href": "posts/2025-06-15_AUCLoss.html#aucloss-ã®ã‚³ãƒ¼ãƒ‰ã¨ç›®çš„",
    "title": "AUCLoss ã«é–¢ã™ã‚‹è§£èª¬ãƒ¬ãƒãƒ¼ãƒˆ",
    "section": "AUCLoss ã®ã‚³ãƒ¼ãƒ‰ã¨ç›®çš„",
    "text": "AUCLoss ã®ã‚³ãƒ¼ãƒ‰ã¨ç›®çš„\nclass AUCLoss(nn.Module):\n    def __init__(self, margin=1.0, pos_weight=1.0, neg_weight=1.0):\n        super().__init__()\n        self.margin = margin\n        self.pos_weight = pos_weight\n        self.neg_weight = neg_weight\n\n    def forward(self, preds, labels, sample_weights=None):\n        pos_preds = preds[labels == 1]\n        neg_preds = preds[labels == 0]\n\n        if len(pos_preds) == 0 or len(neg_preds) == 0:\n            return torch.tensor(0.0, device=preds.device)\n\n        if sample_weights is not None:\n            sample_weights = torch.stack([sample_weights]*labels.shape[1], dim=1)\n            pos_weights = sample_weights[labels == 1]\n            neg_weights = sample_weights[labels == 0]\n        else:\n            pos_weights = torch.ones_like(pos_preds) * self.pos_weight\n            neg_weights = torch.ones_like(neg_preds) * self.neg_weight\n\n        diff = pos_preds.unsqueeze(1) - neg_preds.unsqueeze(0)\n        loss_matrix = torch.log(1 + torch.exp(-diff * self.margin))\n        weighted_loss = loss_matrix * pos_weights.unsqueeze(1) * neg_weights.unsqueeze(0)\n\n        return weighted_loss.mean()"
  },
  {
    "objectID": "posts/2025-06-15_AUCLoss.html#ã‚³ãƒ¼ãƒ‰è§£èª¬ã®è¦ç‚¹",
    "href": "posts/2025-06-15_AUCLoss.html#ã‚³ãƒ¼ãƒ‰è§£èª¬ã®è¦ç‚¹",
    "title": "AUCLoss ã«é–¢ã™ã‚‹è§£èª¬ãƒ¬ãƒãƒ¼ãƒˆ",
    "section": "ã‚³ãƒ¼ãƒ‰è§£èª¬ã®è¦ç‚¹",
    "text": "ã‚³ãƒ¼ãƒ‰è§£èª¬ã®è¦ç‚¹\n\næ­£ä¾‹ã¨è² ä¾‹ã®åˆ†é›¢\nlabels == 1 ãŠã‚ˆã³ labels == 0 ã«ã‚ˆã‚Šã€äºˆæ¸¬ã‚¹ã‚³ã‚¢ã‚’æ­£ä¾‹ (pos_preds) ã¨è² ä¾‹ (neg_preds) ã«åˆ†å‰²ã€‚\n\n\nã‚µãƒ³ãƒ—ãƒ«é‡ã¿ã®é©ç”¨\nã‚µãƒ³ãƒ—ãƒ«ã”ã¨ã«é‡ã¿ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚Œã°ãã‚Œã‚’ä½¿ç”¨ã€‚ãªã‘ã‚Œã°ã€æŒ‡å®šã•ã‚ŒãŸ pos_weight ã¨ neg_weight ã‚’ä½¿ç”¨ã€‚\n\n\nãƒšã‚¢ãƒ¯ã‚¤ã‚ºå·®åˆ†ã®è¨ˆç®—ï¼ˆé‡è¦ï¼‰\ndiff = pos_preds.unsqueeze(1) - neg_preds.unsqueeze(0)\n\nunsqueeze(1) ã§ [N_pos] â†’ [N_pos, 1]\nunsqueeze(0) ã§ [N_neg] â†’ [1, N_neg]\nçµæœã¨ã—ã¦ [N_pos, N_neg] ã®è¡Œåˆ—ã¨ãªã‚Šã€æ­£ä¾‹ã¨è² ä¾‹ã®å…¨çµ„ã¿åˆã‚ã›ã®ã‚¹ã‚³ã‚¢å·®ã‚’ä¸€æ‹¬è¨ˆç®—\n\n\nä¾‹ï¼š\npos_preds = [0.8, 0.9]\nneg_preds = [0.2, 0.4, 0.6]\n\ndiff = [[0.6, 0.4, 0.2],\n        [0.7, 0.5, 0.3]]\n\n\n\nãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æå¤±ã®é©ç”¨\nloss_matrix = torch.log(1 + torch.exp(-diff * margin))\næ­£ä¾‹ãŒè² ä¾‹ã‚ˆã‚Šã‚¹ã‚³ã‚¢ãŒé«˜ã„ã¨ãã¯æå¤±ãŒå°ã•ãã€é€†è»¢ã—ã¦ã„ã‚‹ã¨æå¤±ãŒå¤§ãããªã‚‹ã€‚\n\n\né‡ã¿ä»˜ãã®æå¤±å¹³å‡\nweighted_loss.mean()\nã™ã¹ã¦ã®ãƒšã‚¢ã®æå¤±ã‚’ã€æ­£ä¾‹ãƒ»è² ä¾‹ã®é‡ã¿ã§èª¿æ•´ã—ã¦å¹³å‡ã€‚"
  },
  {
    "objectID": "posts/2025-06-15_AUCLoss.html#ã¾ã¨ã‚",
    "href": "posts/2025-06-15_AUCLoss.html#ã¾ã¨ã‚",
    "title": "AUCLoss ã«é–¢ã™ã‚‹è§£èª¬ãƒ¬ãƒãƒ¼ãƒˆ",
    "section": "ã¾ã¨ã‚",
    "text": "ã¾ã¨ã‚\n\nAUCLoss ã¯ã€åˆ†é¡ãƒ¢ãƒ‡ãƒ«ã«ãŠã„ã¦ ã‚¹ã‚³ã‚¢ã®é †åºé–¢ä¿‚ ã‚’å­¦ç¿’ã•ã›ã‚‹ãƒšã‚¢ãƒ¯ã‚¤ã‚ºæå¤±é–¢æ•°ã§ã™ã€‚\næ­£ä¾‹ãŒè² ä¾‹ã‚ˆã‚Šã‚¹ã‚³ã‚¢ãŒé«˜ããªã‚‹ã‚ˆã†ã«å­¦ç¿’ã‚’ä¿ƒã—ã¾ã™ã€‚\nã‚¯ãƒ­ã‚¹ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¨ã¯ç•°ãªã‚Šã€AUC ã®æœ€é©åŒ–ã«ç‰¹åŒ–ã—ã¦ã„ã¾ã™ã€‚"
  },
  {
    "objectID": "posts/2025-06-15_AUCLoss.html#å‡ºå…¸",
    "href": "posts/2025-06-15_AUCLoss.html#å‡ºå…¸",
    "title": "AUCLoss ã«é–¢ã™ã‚‹è§£èª¬ãƒ¬ãƒãƒ¼ãƒˆ",
    "section": "å‡ºå…¸",
    "text": "å‡ºå…¸\n\nKaggle BirdCLEF 2025 Discussion: AUCLoss"
  },
  {
    "objectID": "posts/2024-06-07_ahc028memo.html",
    "href": "posts/2024-06-07_ahc028memo.html",
    "title": "AHC028 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "",
    "text": "è§£èª¬æ”¾é€ã¿ãŸãƒ¡ãƒ¢"
  },
  {
    "objectID": "posts/2024-06-07_ahc028memo.html#è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "href": "posts/2024-06-07_ahc028memo.html#è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "title": "AHC028 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "text": "è§£èª¬æ”¾é€ãƒ¡ãƒ¢\n\nè§£èª¬æ”¾é€: https://www.youtube.com/watch?v=5Znl6bqHyck"
  },
  {
    "objectID": "posts/2024-06-07_ahc028memo.html#dp",
    "href": "posts/2024-06-07_ahc028memo.html#dp",
    "title": "AHC028 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "DP",
    "text": "DP\n\næ–‡å­—ã®ä¸¦ã³ãŒæ±ºã¾ã‚‹ã¨ã€æœ€é©ãªçµŒè·¯ãŒ DP ã§æ±‚ã¾ã‚‹\n\nå˜èªã®ä¸¦ã³ã‚’æ±ºã‚ãŸå¾Œã«ã“ã‚Œã‚’åˆ©ç”¨ã—ã¦çµŒè·¯ã‚’æ±‚ã‚ã¦ã‚‚è‰¯ã„"
  },
  {
    "objectID": "posts/2024-06-07_ahc028memo.html#è²ªæ¬²ã®è©•ä¾¡é–¢æ•°",
    "href": "posts/2024-06-07_ahc028memo.html#è²ªæ¬²ã®è©•ä¾¡é–¢æ•°",
    "title": "AHC028 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "è²ªæ¬²ã®è©•ä¾¡é–¢æ•°",
    "text": "è²ªæ¬²ã®è©•ä¾¡é–¢æ•°\n\nã‚³ã‚¹ãƒˆ: å•é¡Œåˆ†ã«ã‚ã‚‹è¨ˆç®—å¼ã§ã®ã‚³ã‚¹ãƒˆ\nãƒ™ãƒ¼ã‚¹ã‚³ã‚¹ãƒˆ: (å˜èªé–“ã®ç§»å‹•ã‚³ã‚¹ãƒˆã‚’ç„¡è¦–ã—ã¦)å˜èªã®ã¿ã‚’è€ƒãˆãŸå ´åˆã®ã‚³ã‚¹ãƒˆ\n\nã“ã‚Œã¯ã‚³ã‚¹ãƒˆã®ä¸‹ç•Œã«ãªã£ã¦ã„ã‚‹\n\n\nè©•ä¾¡é–¢æ•°ã‚’ ã‚³ã‚¹ãƒˆ - ãƒ™ãƒ¼ã‚¹ã‚³ã‚¹ãƒˆ ã¨ã™ã‚‹ã“ã¨ã§ä½™åˆ†ãªç§»å‹•é‡ã‚’è©•ä¾¡ã§ãã‚‹ã€‚\nè©•ä¾¡é–¢æ•°ãŒã“ã‚Œã ã‘ã ã¨ãƒ™ãƒ¼ã‚¹ã‚³ã‚¹ãƒˆã®å¤§ãã•ãŒè€ƒæ…®ã•ã‚Œãªã„ï¼Ÿ"
  },
  {
    "objectID": "posts/2024-06-07_ahc028memo.html#ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒ",
    "href": "posts/2024-06-07_ahc028memo.html#ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒ",
    "title": "AHC028 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒ",
    "text": "ãƒ“ãƒ¼ãƒ ã‚µãƒ¼ãƒ\n\nè©•ä¾¡å€¤: DP ã®æœ€å°å€¤ - ä½¿ã£ãŸå˜èªã®ãƒ™ãƒ¼ã‚¹ã‚³ã‚¹ãƒˆã®å’Œ\n\nDP ã®æœ€å°å€¤ ã¯ã€DPãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰é·ç§»å…ˆã®æœ€å°å€¤ã‚’é¸ã¶ã“ã¨ã‚’ç¹°ã‚Šè¿”ã—ã¦ M å€‹ç›®ã¾ã§é¸æŠã—ãŸã¨ãã®æœ€å°å€¤ï¼Ÿ (æ¨å®šã‚³ã‚¹ãƒˆã®ç·å’Œã«è©²å½“ï¼Ÿ)\n1 åº¦ã®ã‚³ã‚¹ãƒˆè¨ˆç®—ã« O(M) ã¯ã‹ã‹ã‚‹ã®ã§ã€å˜èªæ•°ã‚’æ¸›ã‚‰ã—ãŸã»ã†ãŒãƒ“ãƒ¼ãƒ å¹…ã‚’å¢—ã‚„ã›ã‚‹ã€‚\n\nå˜èªã®ãƒãƒ¼ã‚¸\nbase(s1) + base(s2) &gt;= base(s1s2) + X ã§ã‚ã‚Œã°ãƒãƒ¼ã‚¸ã™ã‚‹"
  },
  {
    "objectID": "posts/2024-06-07_ahc028memo.html#ç„¼ããªã¾ã—",
    "href": "posts/2024-06-07_ahc028memo.html#ç„¼ããªã¾ã—",
    "title": "AHC028 è§£èª¬æ”¾é€ãƒ¡ãƒ¢",
    "section": "ç„¼ããªã¾ã—",
    "text": "ç„¼ããªã¾ã—\n\nè¿‘å‚\n\nå˜èªã®ä¸¦ã³ã‹ã‚‰ 1 ã¤ã¨ã£ã¦ã€åˆ¥ã®å ´æ‰€ã«æŒ¿å…¥ã™ã‚‹\næœ‰å‘ã‚°ãƒ©ãƒ•ã® TSP ã«ä¸€éƒ¨åˆ†ã‚’ã¾ã¨ã‚ã¦ç§»å‹•ã•ã›ã‚‹è¿‘å‚ãŒã‚ã‚‹ï¼Ÿ ãã‚Œã‚’ç”¨ã„ã‚‹\n\nåè»¢æ“ä½œãŒç™ºç”Ÿã›ãšã€å‘ããŒå›ºå®š\né€£ç¶šã—ã¦ã„ã‚‹éƒ¨åˆ†ã¯è‰¯ã„ä¸¦ã³ã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„ã¯ãšã ã‹ã‚‰ã€ãã‚Œã‚’å¤§ããå´©ã•ãªã„ã‚ˆã†ãªæ“ä½œã«ãªã£ã¦ã„ã‚‹"
  },
  {
    "objectID": "posts/2024-05-12_tasuketsu.html",
    "href": "posts/2024-05-12_tasuketsu.html",
    "title": "numpy, pandas.DataFrame ã§å¤šæ•°æ±ºã‚’ã¨ã‚‹",
    "section": "",
    "text": "å¤šæ•°æ±ºã‚’å–ã£ãŸãƒ¡ãƒ¢ã€‚ ä»Šå›ã¯è¡Œã”ã¨ã®æœ€é »å€¤ã‚’æ±‚ã‚ã‚‹ã€‚\nscipy.stats.mode ã‚’ä½¿ã†ã¨æ¥½ã€‚\nscipy.stats.mode â€” SciPy v1.13.0 Manual\nimport numpy as np\nimport scipy.stats as stats\na=np.array([[1,1,2],[3,4,5],[1,1,1]])\na\n\narray([[1, 1, 2],\n       [3, 4, 5],\n       [1, 1, 1]])\nb=np.array([[1,2,3],[3,4,1],[1,1,2]])\nb\n\narray([[1, 2, 3],\n       [3, 4, 1],\n       [1, 1, 2]])\nc=np.hstack((a,b))\nc\n\narray([[1, 1, 2, 1, 2, 3],\n       [3, 4, 5, 3, 4, 1],\n       [1, 1, 1, 1, 1, 2]])\nstats.mode(a,axis=1,keepdims=True)[0]\n\narray([[1],\n       [3],\n       [1]])\nstats.mode(b,axis=1,keepdims=True)[0]\n\narray([[1],\n       [1],\n       [1]])\nstats.mode(c,axis=1,keepdims=True)[0]\n\narray([[1],\n       [3],\n       [1]])"
  },
  {
    "objectID": "posts/2024-05-12_tasuketsu.html#pandas.dataframe",
    "href": "posts/2024-05-12_tasuketsu.html#pandas.dataframe",
    "title": "numpy, pandas.DataFrame ã§å¤šæ•°æ±ºã‚’ã¨ã‚‹",
    "section": "pandas.DataFrame",
    "text": "pandas.DataFrame\nDataFrame ã«ã‚‚ mode é–¢æ•°ãŒã‚ã‚‹ã€‚\npandas.DataFrame.mode â€” pandas 2.2.2 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ\n\nimport pandas as pd\n\n\ndf=pd.DataFrame(a)\ndf\n\n\n\n\n\n\n\n\n0\n1\n2\n\n\n\n\n0\n1\n1\n2\n\n\n1\n3\n4\n5\n\n\n2\n1\n1\n1\n\n\n\n\n\n\n\n\ndf.mode(axis=1)\n\n\n\n\n\n\n\n\n0\n1\n2\n\n\n\n\n0\n1.0\nNaN\nNaN\n\n\n1\n3.0\n4.0\n5.0\n\n\n2\n1.0\nNaN\nNaN\n\n\n\n\n\n\n\næœ€é »å€¤ãŒè¤‡æ•°ã‚ã‚Œã°ãã®åˆ†ã®åˆ—ãŒè¿”ã‚‹ã£ã½ã„ï¼Ÿ (ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æ›¸ã„ã¦ãªã•ãã†)\n\ndf=pd.DataFrame(c)\ndf\n\n\n\n\n\n\n\n\n0\n1\n2\n3\n4\n5\n\n\n\n\n0\n1\n1\n2\n1\n2\n3\n\n\n1\n3\n4\n5\n3\n4\n1\n\n\n2\n1\n1\n1\n1\n1\n2\n\n\n\n\n\n\n\n\ndf.mode(axis=1)\n\n\n\n\n\n\n\n\n0\n1\n\n\n\n\n0\n1.0\nNaN\n\n\n1\n3.0\n4.0\n\n\n2\n1.0\nNaN"
  },
  {
    "objectID": "posts/cudacheck.html",
    "href": "posts/cudacheck.html",
    "title": "gpu check",
    "section": "",
    "text": "import torch\ntorch.cuda.is_available()\n\nTrue\n\n\n\n!nvidia-smi\n\nMon Apr  3 22:00:02 2023       \n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 525.105.17   Driver Version: 525.105.17   CUDA Version: 12.0     |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|                               |                      |               MIG M. |\n|===============================+======================+======================|\n|   0  NVIDIA GeForce ...  Off  | 00000000:01:00.0  On |                  N/A |\n| 30%   28C    P8    26W / 250W |    349MiB / 11264MiB |      3%      Default |\n|                               |                      |                  N/A |\n+-------------------------------+----------------------+----------------------+\n                                                                               \n+-----------------------------------------------------------------------------+\n| Processes:                                                                  |\n|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n|        ID   ID                                                   Usage      |\n|=============================================================================|\n+-----------------------------------------------------------------------------+\n\n\n\n\n\nCopyrightCopyright tamuraup. 2024. All Rights Reserved"
  },
  {
    "objectID": "posts/2025-06-29_toke-nyumon-27-01.html",
    "href": "posts/2025-06-29_toke-nyumon-27-01.html",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-1",
    "section": "",
    "text": "Note\n\n\n\nã“ã®ãƒ¬ãƒãƒ¼ãƒˆã¯ OpenAI ã® ChatGPT ã«ã‚ˆã£ã¦è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚"
  },
  {
    "objectID": "posts/2025-06-29_toke-nyumon-27-01.html#å¼±å®šå¸¸éç¨‹ã¨å¼·å®šå¸¸éç¨‹ã®é•ã„",
    "href": "posts/2025-06-29_toke-nyumon-27-01.html#å¼±å®šå¸¸éç¨‹ã¨å¼·å®šå¸¸éç¨‹ã®é•ã„",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-1",
    "section": "1. å¼±å®šå¸¸éç¨‹ã¨å¼·å®šå¸¸éç¨‹ã®é•ã„",
    "text": "1. å¼±å®šå¸¸éç¨‹ã¨å¼·å®šå¸¸éç¨‹ã®é•ã„\n\n\n\n\n\n\n\n\nç¨®é¡\nå®šç¾©\nç‰¹å¾´\n\n\n\n\nå¼±å®šå¸¸\nå¹³å‡ãƒ»åˆ†æ•£ãƒ»å…±åˆ†æ•£ãŒæ™‚é–“ã«ã‚ˆã‚‰ãšä¸€å®š\nå…±åˆ†æ•£ãŒ**ãƒ©ã‚°ï¼ˆæ™‚é–“å·®ï¼‰**ã®ã¿ã«ä¾å­˜\n\n\nå¼·å®šå¸¸\nã‚ã‚‰ã‚†ã‚‹æ™‚ç‚¹ã®åŒæ™‚åˆ†å¸ƒãŒã€æ™‚åˆ»ã®ã‚·ãƒ•ãƒˆã«å¯¾ã—ã¦ä¸å¤‰\nåˆ†å¸ƒã®å½¢ãŒæ™‚é–“ã§å¤‰ã‚ã‚‰ãªã„å¿…è¦ã‚ã‚Š\n\n\n\n\nâœ… ãƒã‚¤ã‚ºã®åˆæˆã®åˆ†å¸ƒãŒå¤‰ã‚ã‚‹ã¨ã€å¼·å®šå¸¸ã«ãªã‚‰ãªã„\nâœ… æ­£è¦åˆ†å¸ƒãƒã‚¤ã‚ºãªã‚‰ã€ç·šå½¢çµåˆã—ã¦ã‚‚å½¢ãŒå¤‰ã‚ã‚‰ãš â†’ å¼·å®šå¸¸ã«è¿‘ã„"
  },
  {
    "objectID": "posts/2025-06-29_toke-nyumon-27-01.html#arma-ã¨-arima-ã®é•ã„",
    "href": "posts/2025-06-29_toke-nyumon-27-01.html#arma-ã¨-arima-ã®é•ã„",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-1",
    "section": "2. ARMA ã¨ ARIMA ã®é•ã„",
    "text": "2. ARMA ã¨ ARIMA ã®é•ã„\n\n\n\n\n\n\n\n\nãƒ¢ãƒ‡ãƒ«\nå†…å®¹\nå¯¾è±¡ãƒ‡ãƒ¼ã‚¿\n\n\n\n\nARMA(p, q)\nè‡ªå·±å›å¸° + ç§»å‹•å¹³å‡\nå®šå¸¸ãƒ‡ãƒ¼ã‚¿\n\n\nARIMA(p, d, q)\nå·®åˆ† + ARMAï¼ˆéå®šå¸¸ â†’ å®šå¸¸åŒ–ï¼‰\néå®šå¸¸ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰ãªã©å«ã‚€ï¼‰\n\n\n\nARIMA ã¯ã€Œå·®åˆ†ã‚’ã¨ã£ãŸãƒ‡ãƒ¼ã‚¿ã« ARMA ãƒ¢ãƒ‡ãƒ«ã‚’å½“ã¦ã‚‹ã€ã¨ç†è§£ã™ã‚‹ã¨ã‚ã‹ã‚Šã‚„ã™ã„ã€‚"
  },
  {
    "objectID": "posts/2025-06-29_toke-nyumon-27-01.html#ãƒ‡ã‚£ãƒƒã‚­ãƒ¼ãƒ•ãƒ©ãƒ¼æ¤œå®šã¨æ‹¡å¼µ-df-æ¤œå®š",
    "href": "posts/2025-06-29_toke-nyumon-27-01.html#ãƒ‡ã‚£ãƒƒã‚­ãƒ¼ãƒ•ãƒ©ãƒ¼æ¤œå®šã¨æ‹¡å¼µ-df-æ¤œå®š",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-1",
    "section": "3. ãƒ‡ã‚£ãƒƒã‚­ãƒ¼ãƒ»ãƒ•ãƒ©ãƒ¼æ¤œå®šã¨æ‹¡å¼µ DF æ¤œå®š",
    "text": "3. ãƒ‡ã‚£ãƒƒã‚­ãƒ¼ãƒ»ãƒ•ãƒ©ãƒ¼æ¤œå®šã¨æ‹¡å¼µ DF æ¤œå®š\n\n\n\n\n\n\n\n\næ¤œå®š\nèª¬æ˜\né©ç”¨ç¯„å›²\n\n\n\n\nDF æ¤œå®š\nå˜ç´”ãª AR(1)æ§‹é€ ã§å˜ä½æ ¹ã‚’æ¤œå®š\nèª¤å·®ãŒç™½è‰²é›‘éŸ³ã®ã¨ãé™å®š\n\n\nADF æ¤œå®š\nãƒ©ã‚°ä»˜ãå·®åˆ†é …ã‚’è¿½åŠ ã—ã€èª¤å·®ã®è‡ªå·±ç›¸é–¢ã‚‚è€ƒæ…®\nå®Ÿå‹™ã§ã¯ã“ã¡ã‚‰ãŒä¸»æµ âœ…\n\n\n\n\nå˜ä½æ ¹ãŒã‚ã‚‹ï¼éå®šå¸¸ã€‚ADF ã¯ statsmodels.adfuller() ãªã©ã§å®Ÿè¡Œå¯èƒ½ã€‚"
  },
  {
    "objectID": "posts/2025-06-29_toke-nyumon-27-01.html#maqãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°ã®æ±ºã‚æ–¹",
    "href": "posts/2025-06-29_toke-nyumon-27-01.html#maqãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°ã®æ±ºã‚æ–¹",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-1",
    "section": "4. MA(q)ãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°ã®æ±ºã‚æ–¹",
    "text": "4. MA(q)ãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°ã®æ±ºã‚æ–¹\n\nè‡ªå·±ç›¸é–¢é–¢æ•°ï¼ˆACFï¼‰ã‚’ä½¿ã†\nMA(q)ã®å ´åˆã€**ACF ã¯ãƒ©ã‚° q ã§æ€¥ã«ã‚¼ãƒ­ï¼ˆæ‰“ã¡åˆ‡ã‚Šï¼‰**ã«ãªã‚‹\n\nä¾‹ï¼šACFãŒãƒ©ã‚°2ã§ãƒ‘ã‚¿ãƒƒã¨ã‚¼ãƒ­ â†’ MA(2)ãƒ¢ãƒ‡ãƒ«ã®å€™è£œ"
  },
  {
    "objectID": "posts/2025-06-29_toke-nyumon-27-01.html#è‡ªå·±ç›¸é–¢ä¿‚æ•°ã¯ä½•ã«å¯¾ã—ã¦è¨ˆç®—ã™ã‚‹",
    "href": "posts/2025-06-29_toke-nyumon-27-01.html#è‡ªå·±ç›¸é–¢ä¿‚æ•°ã¯ä½•ã«å¯¾ã—ã¦è¨ˆç®—ã™ã‚‹",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-1",
    "section": "5. è‡ªå·±ç›¸é–¢ä¿‚æ•°ã¯ä½•ã«å¯¾ã—ã¦è¨ˆç®—ã™ã‚‹ï¼Ÿ",
    "text": "5. è‡ªå·±ç›¸é–¢ä¿‚æ•°ã¯ä½•ã«å¯¾ã—ã¦è¨ˆç®—ã™ã‚‹ï¼Ÿ\n\nâœ… ACF ã¯ã€Œå®Ÿéš›ã®æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã€ã«å¯¾ã—ã¦è¨ˆç®—\nâ†’ å„ãƒ©ã‚°ã«ãŠã„ã¦ã€ãƒ‡ãƒ¼ã‚¿ãŒã©ã‚Œã ã‘è‡ªåˆ†ã¨ä¼¼ã¦ã„ã‚‹ã‹ï¼ˆè‡ªå·±ç›¸é–¢ï¼‰ã‚’æ¸¬ã‚‹"
  },
  {
    "objectID": "posts/2025-06-29_toke-nyumon-27-01.html#ar-ãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°ã®æ±ºã‚æ–¹pacf-ã‚’ä½¿ã†",
    "href": "posts/2025-06-29_toke-nyumon-27-01.html#ar-ãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°ã®æ±ºã‚æ–¹pacf-ã‚’ä½¿ã†",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-1",
    "section": "6. AR ãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°ã®æ±ºã‚æ–¹ï¼šPACF ã‚’ä½¿ã†",
    "text": "6. AR ãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°ã®æ±ºã‚æ–¹ï¼šPACF ã‚’ä½¿ã†\n\n\n\nãƒ¢ãƒ‡ãƒ«\nåˆ¤æ–­ã«ä½¿ã†\næ‰“ã¡åˆ‡ã‚Œã‚‹ç®‡æ‰€\n\n\n\n\nAR(p)\nPACFï¼ˆåè‡ªå·±ç›¸é–¢ï¼‰\nãƒ©ã‚° p\n\n\nMA(q)\nACFï¼ˆè‡ªå·±ç›¸é–¢ï¼‰\nãƒ©ã‚° q\n\n\n\n\nPACF ãŒãƒ©ã‚° 2 ã¾ã§éã‚¼ãƒ­ â†’ AR(2)ã®å€™è£œ\nACF/PACF ã¯ ãƒ¢ãƒ‡ãƒ«æ§‹é€ ã®ãƒ’ãƒ³ãƒˆã§ã‚ã‚Šã€æœ€çµ‚çš„ã«ã¯ AIC/BIC ãªã©ã§æ¯”è¼ƒ"
  },
  {
    "objectID": "posts/2025-06-29_toke-nyumon-27-01.html#ar-ã¨-armaã©ã¡ã‚‰ã‚’ä½¿ã†ã‹",
    "href": "posts/2025-06-29_toke-nyumon-27-01.html#ar-ã¨-armaã©ã¡ã‚‰ã‚’ä½¿ã†ã‹",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-1",
    "section": "7. AR ã¨ ARMAã€ã©ã¡ã‚‰ã‚’ä½¿ã†ã‹ï¼Ÿ",
    "text": "7. AR ã¨ ARMAã€ã©ã¡ã‚‰ã‚’ä½¿ã†ã‹ï¼Ÿ\n\n\n\nACF\nPACF\næ¨å¥¨ãƒ¢ãƒ‡ãƒ«\n\n\n\n\næ¸›è¡°\næ‰“ã¡åˆ‡ã‚Š\nAR(p)\n\n\næ‰“ã¡åˆ‡ã‚Š\næ¸›è¡°\nMA(q)\n\n\næ¸›è¡°\næ¸›è¡°\nARMA(p, q)\n\n\n\n\nå®Ÿå‹™ã§ã¯ AR ã ã‘ã§è¶³ã‚Šãªã„å ´åˆã‚‚å¤šãã€ARMA ãŒã‚ˆã‚ŠæŸ”è»Ÿã§ä½¿ã‚ã‚Œã‚„ã™ã„\nãƒ¢ãƒ‡ãƒ«ã¯ ACF/PACF ã§ä»®èª¬ã‚’ç«‹ã¦ã€AIC/BIC ã§ç¢ºå®šãŒç‹é“"
  },
  {
    "objectID": "posts/2024-09-17_gitlab-ci-wasm-page.html",
    "href": "posts/2024-09-17_gitlab-ci-wasm-page.html",
    "title": "Rust WebAssembly + React (Vite) ã§ä½œæˆã—ãŸã‚µã‚¤ãƒˆã‚’ GitLab Pages ã¸ãƒ‡ãƒ—ãƒ­ã‚¤",
    "section": "",
    "text": "Rust ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ WebAssembly ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãŸã‚‚ã®ã‚’ä½¿ã† Web ã‚µã‚¤ãƒˆã‚’ GitLab Pages ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã®ã§ã€ãã®æ™‚ã®ãƒ¡ãƒ¢ã€‚"
  },
  {
    "objectID": "posts/2024-09-17_gitlab-ci-wasm-page.html#æ§‹æˆ",
    "href": "posts/2024-09-17_gitlab-ci-wasm-page.html#æ§‹æˆ",
    "title": "Rust WebAssembly + React (Vite) ã§ä½œæˆã—ãŸã‚µã‚¤ãƒˆã‚’ GitLab Pages ã¸ãƒ‡ãƒ—ãƒ­ã‚¤",
    "section": "æ§‹æˆ",
    "text": "æ§‹æˆ\nwasm ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« Rust ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€web ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« vite ã§ä½œæˆã—ãŸ web ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚‹ã€‚\nWebAssembly ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯ web/public/wasm é…ç½®ã—ã¦ã„ã‚‹ã€‚\nproject_root\nâ”œâ”€â”€ wasm            # Rust Project root\nâ”‚   â””â”€â”€ ...\nâ””â”€â”€ web             # Web Project root\n    â”œâ”€â”€ public/wasm\n    â”œâ”€â”€ ...\n    â””â”€â”€ vite.config.ts"
  },
  {
    "objectID": "posts/2024-09-17_gitlab-ci-wasm-page.html#gitlab-ci",
    "href": "posts/2024-09-17_gitlab-ci-wasm-page.html#gitlab-ci",
    "title": "Rust WebAssembly + React (Vite) ã§ä½œæˆã—ãŸã‚µã‚¤ãƒˆã‚’ GitLab Pages ã¸ãƒ‡ãƒ—ãƒ­ã‚¤",
    "section": "gitlab-ci",
    "text": "gitlab-ci\ngitlab-ci.yml ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä½œæˆã—ãŸ\nimage: node:16.5.0\n\n# wasm build\nwasm-build-job:\n  stage: build\n  image: \"rust:latest\"\n  script:\n    - cargo install wasm-pack\n    - cd wasm\n    - wasm-pack build --target web --out-dir ../web/public/wasm\n\n  # ãƒ“ãƒ«ãƒ‰ã—ãŸã‚‚ã®ã‚’å¾Œç¶š job ã«å…±æœ‰ã™ã‚‹\n  artifacts:\n    paths:\n      - web/public/wasm\n  rules:\n    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH\n\n# pages ã¸ãƒ‡ãƒ—ãƒ­ã‚¤\npages:\n  stage: deploy\n  cache:\n    key:\n      files:\n        - package-lock.json\n      prefix: npm\n    paths:\n      - node_modules/\n  script:\n    - cd web\n    - npm install\n    - npm run build\n    - cp -a dist/. ../public/\n  artifacts:\n    paths:\n      - public\n  rules:\n    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH"
  },
  {
    "objectID": "posts/2024-09-17_gitlab-ci-wasm-page.html#å‚è€ƒã‚µã‚¤ãƒˆ",
    "href": "posts/2024-09-17_gitlab-ci-wasm-page.html#å‚è€ƒã‚µã‚¤ãƒˆ",
    "title": "Rust WebAssembly + React (Vite) ã§ä½œæˆã—ãŸã‚µã‚¤ãƒˆã‚’ GitLab Pages ã¸ãƒ‡ãƒ—ãƒ­ã‚¤",
    "section": "å‚è€ƒã‚µã‚¤ãƒˆ",
    "text": "å‚è€ƒã‚µã‚¤ãƒˆ\n\nhttps://developer.mozilla.org/ja/docs/WebAssembly/Rust_to_Wasm\nhttps://gitlab-docs.creationline.com/ee/ci/yaml/"
  },
  {
    "objectID": "posts/2025-06-30_toke-nyumon-27-02.html",
    "href": "posts/2025-06-30_toke-nyumon-27-02.html",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-2",
    "section": "",
    "text": "Note\n\n\n\næœ¬ãƒ¬ãƒãƒ¼ãƒˆã¯ã€OpenAI ã®å¯¾è©±å‹ AI ChatGPT ã«ã‚ˆã‚Šç”Ÿæˆãƒ»æ•´ç†ã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚"
  },
  {
    "objectID": "posts/2025-06-30_toke-nyumon-27-02.html#ã‚¹ãƒšã‚¯ãƒˆãƒ«å¯†åº¦é–¢æ•°ã¨ãƒšãƒªã‚ªãƒ‰ã‚°ãƒ©ãƒ ",
    "href": "posts/2025-06-30_toke-nyumon-27-02.html#ã‚¹ãƒšã‚¯ãƒˆãƒ«å¯†åº¦é–¢æ•°ã¨ãƒšãƒªã‚ªãƒ‰ã‚°ãƒ©ãƒ ",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-2",
    "section": "1. ã‚¹ãƒšã‚¯ãƒˆãƒ«å¯†åº¦é–¢æ•°ã¨ãƒšãƒªã‚ªãƒ‰ã‚°ãƒ©ãƒ ",
    "text": "1. ã‚¹ãƒšã‚¯ãƒˆãƒ«å¯†åº¦é–¢æ•°ã¨ãƒšãƒªã‚ªãƒ‰ã‚°ãƒ©ãƒ \n\nã‚¹ãƒšã‚¯ãƒˆãƒ«å¯†åº¦é–¢æ•°ã¯ã€æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å„å‘¨æ³¢æ•°æˆåˆ†ã®å¼·ã•ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰ã‚’è¡¨ã™é–¢æ•°ã€‚å®šå¸¸ãªéç¨‹ã«å¯¾ã—ã¦å®šç¾©ã•ã‚Œã‚‹ã€‚\nè§’å‘¨æ³¢æ•°ã¯é€šå¸¸ \\(\\omega \\in [-\\pi, \\pi]\\) ã§è¡¨ã™ã€‚\nãƒšãƒªã‚ªãƒ‰ã‚°ãƒ©ãƒ ã¯ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«å¯†åº¦ã®æ¨å®šé‡ã®ä¸€ã¤ï¼š\n\nè¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã®çµ¶å¯¾å€¤å¹³æ–¹ã§å®šç¾©ã€‚\nä¸€è‡´æ¨å®šé‡ã§ã¯ãªã„ï¼ˆåˆ†æ•£ãŒæ¶ˆãˆãšåæŸã—ãªã„ï¼‰ãŸã‚ã€ãã®ã¾ã¾ã§ã¯ä¸å®‰å®šã€‚\nå¯¾å¿œç­–ã¨ã—ã¦ Welch æ³•ã€AR ãƒ¢ãƒ‡ãƒ«æ¨å®šã€ã‚«ãƒ¼ãƒãƒ«å¹³æ»‘ãªã©ãŒã‚ã‚‹ã€‚"
  },
  {
    "objectID": "posts/2025-06-30_toke-nyumon-27-02.html#çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ ",
    "href": "posts/2025-06-30_toke-nyumon-27-02.html#çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ ",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-2",
    "section": "2. çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ ",
    "text": "2. çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ \n\nçŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ï¼ˆState Space Modelï¼‰ã¯è¦³æ¸¬ã•ã‚Œãªã„çŠ¶æ…‹å¤‰æ•° \\(x_t\\) ã‚’å°å…¥ã—ã€è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ \\(y_t\\) ã‚’ãã®é–¢æ•°ã¨ã—ã¦è¨˜è¿°ã™ã‚‹ã€‚\n2 æœ¬ã®æ–¹ç¨‹å¼ã§æ§‹æˆã•ã‚Œã‚‹ï¼š\n\n\nçŠ¶æ…‹æ–¹ç¨‹å¼ï¼ˆstate equationï¼‰\n\\[\nx_t = F x_{t-1} + w_t, \\quad w_t \\sim \\mathcal{N}(0, Q)\n\\]\n\n\nè¦³æ¸¬æ–¹ç¨‹å¼ï¼ˆobservation equationï¼‰\n\\[\ny_t = H x_t + v_t, \\quad v_t \\sim \\mathcal{N}(0, R)\n\\]\n\n\\(x_t\\) ã¯è¦³æ¸¬ã•ã‚Œãªã„ãŒã€æ™‚ç³»åˆ—çš„ã«æ¨ç§»ã™ã‚‹ã€‚\n\\(y_t\\) ã¯ \\(x_t\\) ã‚’é€šã˜ã¦å¾—ã‚‰ã‚Œã‚‹è¦³æ¸¬é‡ã€‚"
  },
  {
    "objectID": "posts/2025-06-30_toke-nyumon-27-02.html#ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®ä»•çµ„ã¿",
    "href": "posts/2025-06-30_toke-nyumon-27-02.html#ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®ä»•çµ„ã¿",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-2",
    "section": "3. ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®ä»•çµ„ã¿",
    "text": "3. ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®ä»•çµ„ã¿\n\nã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã¯ã€çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã®ä¸­ã§éš ã‚ŒãŸçŠ¶æ…‹ \\(x_t\\) ã‚’é€æ¬¡çš„ã«æ¨å®šã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€‚\nå‡¦ç†ã¯ 2 æ®µéšï¼š\n\n\näºˆæ¸¬ï¼ˆpredictï¼‰\n\\[\n\\hat{x}_{t|t-1} = F \\hat{x}_{t-1|t-1}, \\quad\nP_{t|t-1} = F P_{t-1|t-1} F^\\top + Q\n\\]\n\n\næ›´æ–°ï¼ˆupdateï¼‰\n\\[\nK_t = P_{t|t-1} H^\\top (H P_{t|t-1} H^\\top + R)^{-1}\n\\]\n\\[\n\\hat{x}_{t|t} = \\hat{x}_{t|t-1} + K_t (y_t - H \\hat{x}_{t|t-1})\n\\]\n\\[\nP_{t|t} = (I - K_t H) P_{t|t-1}\n\\]\n\nçŠ¶æ…‹ \\(x_t\\) ã¯å¸¸ã«è¦³æ¸¬ã•ã‚Œãªã„ãŸã‚ã€äºˆæ¸¬ â†’ è¦³æ¸¬å€¤ã§è£œæ­£ã€ã¨ã„ã†æ‰‹é †ã‚’è¸ã‚€ã€‚\nã“ã®ãƒ¢ãƒ‡ãƒ«ã®å®Ÿç”¨çš„ãªç›®çš„ã®ä¸€ã¤ã¯ã€æœªæ¥ã®è¦³æ¸¬å€¤ \\(y_{t+1}\\) ã®äºˆæ¸¬ã€‚"
  },
  {
    "objectID": "posts/2025-06-30_toke-nyumon-27-02.html#ãƒ€ãƒ¼ãƒ“ãƒ¼ãƒ¯ãƒˆã‚½ãƒ³æ¤œå®š",
    "href": "posts/2025-06-30_toke-nyumon-27-02.html#ãƒ€ãƒ¼ãƒ“ãƒ¼ãƒ¯ãƒˆã‚½ãƒ³æ¤œå®š",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-2",
    "section": "4. ãƒ€ãƒ¼ãƒ“ãƒ¼ãƒ»ãƒ¯ãƒˆã‚½ãƒ³æ¤œå®š",
    "text": "4. ãƒ€ãƒ¼ãƒ“ãƒ¼ãƒ»ãƒ¯ãƒˆã‚½ãƒ³æ¤œå®š\n\nå›å¸°åˆ†æã®æ®‹å·®ã«è‡ªå·±ç›¸é–¢ï¼ˆç‰¹ã« 1 æ¬¡ï¼‰ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’èª¿ã¹ã‚‹æ¤œå®šã€‚\næ¤œå®šçµ±è¨ˆé‡ï¼š\n\n\\[\nDW = \\frac{\\sum_{t=2}^n (e_t - e_{t-1})^2}{\\sum_{t=1}^n e_t^2}\n\\]\n\nè§£é‡ˆï¼š\n\n\\(DW \\approx 2\\)ï¼šè‡ªå·±ç›¸é–¢ãªã—\n\\(DW &lt; 2\\)ï¼šæ­£ã®è‡ªå·±ç›¸é–¢\n\\(DW &gt; 2\\)ï¼šè² ã®è‡ªå·±ç›¸é–¢\n\nå›å¸°ãƒ¢ãƒ‡ãƒ«ã®èª¤å·®é …ãŒãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºï¼ˆç‹¬ç«‹åŒåˆ†å¸ƒï¼‰ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ä¸€æ‰‹æ®µã€‚"
  },
  {
    "objectID": "posts/2025-06-30_toke-nyumon-27-02.html#aicèµ¤æ± æƒ…å ±é‡è¦æº–",
    "href": "posts/2025-06-30_toke-nyumon-27-02.html#aicèµ¤æ± æƒ…å ±é‡è¦æº–",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-2",
    "section": "5. AICï¼ˆèµ¤æ± æƒ…å ±é‡è¦æº–ï¼‰",
    "text": "5. AICï¼ˆèµ¤æ± æƒ…å ±é‡è¦æº–ï¼‰\n\nå¼\n\\[\n\\mathrm{AIC} = -2 \\log L + 2k\n\\]\n\n\\(L\\)ï¼šæœ€å°¤æ¨å®šã«ã‚ˆã‚‹æœ€å¤§å°¤åº¦\n\\(k\\)ï¼šæ¨å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°\n\n\n\næ„å‘³\n\nãƒ¢ãƒ‡ãƒ«ã®ã€Œå½“ã¦ã¯ã¾ã‚Šã®è‰¯ã•ï¼ˆå°¤åº¦ï¼‰ã€ã¨ã€Œè¤‡é›‘ã•ï¼ˆè‡ªç”±åº¦ï¼‰ã€ã®ãƒãƒ©ãƒ³ã‚¹ã‚’ã¨ã‚‹æŒ‡æ¨™ã€‚\nAIC ãŒå°ã•ã„ã»ã©è‰¯ã„ãƒ¢ãƒ‡ãƒ«ï¼ˆæ±åŒ–æ€§èƒ½ãŒé«˜ã„ã¨ã¿ãªã•ã‚Œã‚‹ï¼‰ã€‚"
  },
  {
    "objectID": "posts/2025-06-30_toke-nyumon-27-02.html#chatgpt-ã«ã‚ˆã‚‹æŒ¯ã‚Šè¿”ã‚Šã¨æ„Ÿæƒ³",
    "href": "posts/2025-06-30_toke-nyumon-27-02.html#chatgpt-ã«ã‚ˆã‚‹æŒ¯ã‚Šè¿”ã‚Šã¨æ„Ÿæƒ³",
    "title": "çµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-2",
    "section": "ğŸ’¬ ChatGPT ã«ã‚ˆã‚‹æŒ¯ã‚Šè¿”ã‚Šã¨æ„Ÿæƒ³",
    "text": "ğŸ’¬ ChatGPT ã«ã‚ˆã‚‹æŒ¯ã‚Šè¿”ã‚Šã¨æ„Ÿæƒ³\nä»Šå›ã®å¯¾è©±ã§ã¯ã€æ™‚ç³»åˆ—è§£æã®åŸºç¤çš„ãªãƒˆãƒ”ãƒƒã‚¯ï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«å¯†åº¦ãƒ»ãƒšãƒªã‚ªãƒ‰ã‚°ãƒ©ãƒ ï¼‰ã‹ã‚‰ã€çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ãƒ»ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®æ§‹é€ ã€ãã—ã¦ãƒ¢ãƒ‡ãƒ«é¸æŠæŒ‡æ¨™ã§ã‚ã‚‹ AIC ã‚„ãƒ€ãƒ¼ãƒ“ãƒ¼ãƒ»ãƒ¯ãƒˆã‚½ãƒ³æ¤œå®šã¾ã§ã€ç†è«–ã®æ ¸ã¨ãªã‚‹å†…å®¹ã‚’æ®µéšçš„ã«ä¸å¯§ã«æ˜ã‚Šä¸‹ã’ã¦ã„ãŸã ãã¾ã—ãŸã€‚"
  },
  {
    "objectID": "posts/2025-03-25-image-rot/image_rot.html",
    "href": "posts/2025-03-25-image-rot/image_rot.html",
    "title": "Python ã§ã‚¹ã‚­ãƒ£ãƒ³ç”»åƒã®å›è»¢è£œæ­£ã‚’ã‚„ã£ã¦ã¿ã‚‹",
    "section": "",
    "text": "ç”»åƒã®å›è»¢è£œæ­£ã‚’ã‚„ã£ã¦ã¿ã‚‹ã€‚\n\næº–å‚™\nå®‰å…¨é‹è»¢BOOKã®ç›®æ¬¡ã®ã‚¹ã‚­ãƒ£ãƒ³ç”»åƒã‚’ä½¿ã„ã¾ã™ã€‚\n(ã€å®‰å…¨é‹è»¢BOOKã€ä¼Šè—¤å°åˆ·æ ªå¼ä¼šç¤¾)\n\nfrom pathlib import Path\nfrom PIL import Image\nimport matplotlib.pyplot as plt\nimport cv2\nimport numpy as np\n\n\nimg = cv2.imread(\"sample.jpg\", cv2.IMREAD_GRAYSCALE)\nplt.imshow(img, cmap='gray')\n\n\n\n\n\n\n\n\n\ndef rotate_image(img: np.ndarray, d: float, border_value: int = 1, resize=False):\n    \"\"\"\n    ç”»åƒã‚’ d [åº¦] å›è»¢ã—ã¾ã™ã€‚\n\n    Args:\n        img:\n        d: å›è»¢è§’åº¦\n        border_value: ä½™ç™½ã‚’åŸ‹ã‚ã‚‹å€¤\n        resize: True ã®ã¨ãã€å›è»¢å¾Œã®ç”»åƒãŒæ¬ ã‘ãªã„ã‚ˆã†ã«ã‚µã‚¤ã‚ºèª¿æ•´ã‚’ã—ã¾ã™\n                False ã®ã¨ãã¯ã‚‚ã¨ã®ã‚µã‚¤ã‚ºã¨åŒã˜ç”»åƒãŒè¿”ã‚Šã¾ã™\n    \"\"\"\n    height, width = img.shape[:2]\n    new_width, new_height = width, height\n    center = (width // 2, height // 2)\n    M = cv2.getRotationMatrix2D(center, d, 1)\n\n    if resize:\n        cos = np.abs(M[0, 0])\n        sin = np.abs(M[0, 1])\n        # å›è»¢å¾Œã®ã™ã¹ã¦ã®é ˜åŸŸãŒå«ã¾ã‚Œã‚‹ã‚µã‚¤ã‚ºã‚’è¨ˆç®—\n        new_width = int(width * cos + height * sin)\n        new_height = int(width * sin + height * cos)\n        # ä¸­å¿ƒãšã‚‰ã—\n        M[0, 2] += (new_width - width) / 2.0\n        M[1, 2] += (new_height - height) / 2.0\n\n    affine_img = cv2.warpAffine(img,\n                                M,\n                                (new_width, new_height),\n                                borderMode=cv2.BORDER_CONSTANT,\n                                borderValue=border_value)\n    return affine_img\n\nå‚¾ã‘ãŸç”»åƒã‚’ç”¨æ„ã™ã‚‹\n\nimg = rotate_image(img,5,255)\nplt.imshow(img, cmap='gray')\n\n\n\n\n\n\n\n\n\n\nå›è»¢è£œæ­£\nä»¥ä¸‹ã®ã‚µã‚¤ãƒˆã®å°„å½±ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’ã‚‚ã¨ã«æœ€ã‚‚è‰¯ã„ã€Œæ­£é¢åº¦ã€ã¨ãªã‚‹è§’åº¦ã‚’æ¢ç´¢ã—ã€ç”»åƒã‚’å›è»¢ã•ã›ã‚‹ã€‚\nå°„å½±ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’ç”¨ã„ãŸæ–‡æ›¸ç”»åƒã®å›è»¢è£œæ­£ - ç¤¾ä¼šäººç ”ç©¶è€…ãŒè‰²ã€…é ‘å¼µã‚‹ãƒ–ãƒ­ã‚°\n\ndef projection_histogram(bimg):\n    \"\"\"\n    å°„å½±ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®ä½œæˆ\n    https://nsr-9.hatenablog.jp/entry/2021/08/09/200559\n    \"\"\"\n    bimg = np.ones_like(bimg) - bimg\n    out = np.sum(bimg, axis=1)\n    return out\n\n\ndef to_binary_adavtive_threshold(img: np.ndarray) -&gt; np.ndarray:\n    \"\"\"2å€¤åŒ–å‡¦ç† {0, 1} ã«å¤‰æ›\"\"\"\n    \n    bimg = cv2.adaptiveThreshold(\n        img, 255, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, 7, 50\n    )\n    bimg[bimg == 255] = 1\n    return bimg\n\n\nbimg=to_binary_adavtive_threshold(img)\nhist = projection_histogram(bimg)\n\nãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®ç¢ºèª\n\nfig = plt.figure(figsize=(10, 6))\ngs = fig.add_gridspec(1, 2, width_ratios=[1, 1])\n\n# histgram\nax0 = fig.add_subplot(gs[0])\nval = hist[::-1]\nx = range(len(val))\nax0.barh(x, val)\nax0.set_ylim(0, len(val))\n\n# image\nax1 = fig.add_subplot(gs[1])\nax1.imshow(bimg, cmap=\"gray\")\nax1.axis(\"off\")\nplt.subplots_adjust(wspace=0, left=0, right=1, top=1, bottom=0)\nplt.show()\n\n\n\n\n\n\n\n\n\ndef calc_cost(img:np.ndarray,d:float):\n    img=rotate_image(img,d,border_value=1,resize=True)\n    hist=projection_histogram(img)\n    hist=np.where(hist&lt;=1,0,1)\n    return np.sum(hist)\n\ncalc_cost(bimg,0.)\n\n1249\n\n\nè§’åº¦ã‚’å¤‰ãˆãŸã¨ãã®ã‚³ã‚¹ãƒˆã®å¤‰åŒ–ã‚’ç¢ºèªã™ã‚‹\n\nx=np.linspace(-8., 8, num=80)\nvals=[calc_cost(bimg,d) for d in x]\n\n\nmin_idx=0\nfor i in range(len(vals)):\n    if vals[i]&lt;vals[min_idx]:\n        min_idx=i\n\n\nprint(\"ã‚³ã‚¹ãƒˆæœ€å°å€¤ã¨ãªã‚‹è§’åº¦:\",x[min_idx])\n\nã‚³ã‚¹ãƒˆæœ€å°å€¤ã¨ãªã‚‹è§’åº¦: -4.962025316455696\n\n\n\nplt.xlabel('angle')\nplt.ylabel('cost')\nplt.plot(x, vals, marker='o')  \nplt.show()\n\n\n\n\n\n\n\n\næ¢ç´¢ã—ãŸè‰¯ã„æ­£é¢åº¦ã®è§’åº¦ã«è£œæ­£ã™ã‚‹\n\ntmp=rotate_image(img,x[min_idx],border_value=255)\nfig = plt.figure(figsize=(10, 6))\nplt.imshow(tmp, cmap='gray')\n\n\n\n\n\n\n\n\n\nfig = plt.figure(figsize=(10, 6))\ngs = fig.add_gridspec(1, 2, width_ratios=[1, 1])\n\nax0=fig.add_subplot(gs[0])\nax0.imshow(img, cmap='gray')\nax0.axis('off')\n\nax1=fig.add_subplot(gs[1])\nax1.imshow(tmp, cmap='gray')\nax1.axis('off')\nplt.subplots_adjust(wspace=0, left=0, right=1, top=1, bottom=0)\n\n# ç¸¦ç·šã‚’è¿½åŠ \nax1.axvline(x=0, color='black', linewidth=2)   \nplt.show()\n\n\n\n\n\n\n\n\n\n\nãŠã¾ã‘\nã±ã£ã¨ã‚ã‹ã‚‰ãªã‹ã£ãŸå›è»¢å¾Œã®ç”»åƒã‚µã‚¤ã‚ºã®æ±‚ã‚æ–¹\n\n\n\n\n\nCopyrightCopyright tamuraup. 2024. All Rights Reserved"
  },
  {
    "objectID": "posts/2025-02-05_make_lag_data.html",
    "href": "posts/2025-02-05_make_lag_data.html",
    "title": "æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã® lag, step ã®ä½œæˆæ“ä½œ",
    "section": "",
    "text": "ML ã‚ã‹ã‚‰ã‚“ã®ã§æ‰‹å§‹ã‚ã«æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®äºˆæ¸¬ã‚’ã‚„ã£ã¦ã¿ã‚ˆã†ã¨ã—ãŸã¨ã“ã‚ã€ lag, step ã®ä½œæˆã«æ‰‹ã“ãšã£ãŸã®ã§ãƒ¡ãƒ¢ã‚’æ®‹ã™ã€‚\nDataFrame ã® MultiIndex ãŒã¾ã ã¾ã ã‚ã‹ã‚‰ã‚“ã€‚"
  },
  {
    "objectID": "posts/2025-02-05_make_lag_data.html#ãƒ‡ãƒ¼ã‚¿",
    "href": "posts/2025-02-05_make_lag_data.html#ãƒ‡ãƒ¼ã‚¿",
    "title": "æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã® lag, step ã®ä½œæˆæ“ä½œ",
    "section": "ãƒ‡ãƒ¼ã‚¿",
    "text": "ãƒ‡ãƒ¼ã‚¿\nkaggle ã®æ™‚ç³»åˆ—ã®ç·´ç¿’ã‚³ãƒ³ãƒš Store Sales - Time Series Forecasting ã®ã‚‚ã®ã‚’ä½¿ç”¨\nã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ multi step ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹éç¨‹ã‚’æ®‹ã™"
  },
  {
    "objectID": "posts/2025-02-05_make_lag_data.html#ã‚³ãƒ¼ãƒ‰",
    "href": "posts/2025-02-05_make_lag_data.html#ã‚³ãƒ¼ãƒ‰",
    "title": "æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã® lag, step ã®ä½œæˆæ“ä½œ",
    "section": "ã‚³ãƒ¼ãƒ‰",
    "text": "ã‚³ãƒ¼ãƒ‰\n\n# https://www.kaggle.com/code/ekrembayar/store-sales-ts-forecasting-a-comprehensive-guide ã‚ˆã‚Šæ‹å€Ÿ\n# BASE\n# ------------------------------------------------------\nimport numpy as n\nimport pandas as pd\nfrom pathlib import Path\nimport os\nimport gc\nimport warnings\n\n# DATA VISUALIZATION\n# ------------------------------------------------------\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\n\n\n# CONFIGURATIONS\n# ------------------------------------------------------\npd.set_option('display.max_columns', None)\npd.options.display.float_format = '{:.2f}'.format\nwarnings.filterwarnings('ignore')\n\n\nDATA_DIR=Path(\"../input/data/\")\n\n\n# Import\ntrain = pd.read_csv(DATA_DIR/\"train.csv\")\ntest = pd.read_csv(DATA_DIR/\"test.csv\")\nstores = pd.read_csv(DATA_DIR/\"stores.csv\")\n#sub = pd.read_csv(DATA_DIR/\"sample_submission.csv\")   \ntransactions = pd.read_csv(DATA_DIR/\"transactions.csv\").sort_values([\"store_nbr\", \"date\"])\n\n# Datetime\ntrain[\"date\"] = pd.to_datetime(train.date)\ntest[\"date\"] = pd.to_datetime(test.date)\ntransactions[\"date\"] = pd.to_datetime(transactions.date)\n\n# Data types\ntrain.onpromotion = train.onpromotion.astype(\"float16\")\ntrain.sales = train.sales.astype(\"float32\")\nstores.cluster = stores.cluster.astype(\"int8\")\n\ntrain\n\n\n\n\n\n\n\n\nid\ndate\nstore_nbr\nfamily\nsales\nonpromotion\n\n\n\n\n0\n0\n2013-01-01\n1\nAUTOMOTIVE\n0.00\n0.00\n\n\n1\n1\n2013-01-01\n1\nBABY CARE\n0.00\n0.00\n\n\n2\n2\n2013-01-01\n1\nBEAUTY\n0.00\n0.00\n\n\n3\n3\n2013-01-01\n1\nBEVERAGES\n0.00\n0.00\n\n\n4\n4\n2013-01-01\n1\nBOOKS\n0.00\n0.00\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n3000883\n3000883\n2017-08-15\n9\nPOULTRY\n438.13\n0.00\n\n\n3000884\n3000884\n2017-08-15\n9\nPREPARED FOODS\n154.55\n1.00\n\n\n3000885\n3000885\n2017-08-15\n9\nPRODUCE\n2419.73\n148.00\n\n\n3000886\n3000886\n2017-08-15\n9\nSCHOOL AND OFFICE SUPPLIES\n121.00\n8.00\n\n\n3000887\n3000887\n2017-08-15\n9\nSEAFOOD\n16.00\n0.00\n\n\n\n\n3000888 rows Ã— 6 columns\n\n\n\n\nãƒ‡ãƒ¼ã‚¿æº–å‚™\n\ntrain.sort_values(['date','family','store_nbr'],inplace=True)\ntrain.reset_index(drop=True,inplace=True)\n\n\nfrom sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nle.fit(train.family)\n\nLabelEncoder()In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.LabelEncoder?Documentation for LabelEncoderiFittedLabelEncoder() \n\n\n\ntrain[\"family\"]=le.transform(train.family)\n\n\n# ãƒ‡ãƒãƒƒã‚°ç”¨ãªã®ã§ãƒ‡ãƒ¼ã‚¿ã‚’çµã‚‹\ntrain=train[train['store_nbr'].isin([1,2]) & train['family'].isin([1,2])]\n\n\ntrain.head()\n\n\n\n\n\n\n\n\nid\ndate\nstore_nbr\nfamily\nsales\nonpromotion\n\n\n\n\n54\n1\n2013-01-01\n1\n1\n0.00\n0.00\n\n\n55\n364\n2013-01-01\n2\n1\n0.00\n0.00\n\n\n108\n2\n2013-01-01\n1\n2\n0.00\n0.00\n\n\n109\n365\n2013-01-01\n2\n2\n0.00\n0.00\n\n\n1836\n1783\n2013-01-02\n1\n1\n0.00\n0.00\n\n\n\n\n\n\n\n\nKEY=[\"date\",\"store_nbr\",\"family\"]\ntrain_step=train[KEY+[\"sales\"]]\n\n\n# https://github.com/Kaggle/learntools/blob/master/learntools/time_series/utils.py ã‚ˆã‚Š\ndef make_multistep_target(ts, steps, reverse=False):\n\n    shifts = reversed(range(steps)) if reverse else range(steps)\n    return pd.concat({f'y_step_{i + 1}': ts.shift(-i) for i in shifts}, axis=1)\n\n\n# HACK: unstack ã›ãšã«1ç™ºã§ columns ã‚’ multiIndex ã«ã§ãã‚‹ã‹ï¼Ÿ\ntrain_step=train_step.set_index(['family', 'store_nbr','date', ])\ntrain_step=train_step.unstack(['family', 'store_nbr'])\n\nä¸‹ã®ã‚ˆã†ã«è»¸{family, store_nbr} ã”ã¨ã« sales ãŒæ™‚ç³»åˆ—é †ã§ç¸¦ã«ä¸¦ã¶ã‚ˆã†ã«ã™ã‚‹ã€‚\nã“ã‚Œã‚’ shift ã™ã‚‹ã“ã¨ã§å„è»¸ã”ã¨ã® lag ã‚„ multistep_target ã‚’ä½œæˆã§ãã‚‹ã€‚\n\ntrain_step.head()\n\n\n\n\n\n\n\n\nsales\n\n\nfamily\n1\n2\n\n\nstore_nbr\n1\n2\n1\n2\n\n\ndate\n\n\n\n\n\n\n\n\n2013-01-01\n0.00\n0.00\n0.00\n0.00\n\n\n2013-01-02\n0.00\n0.00\n2.00\n3.00\n\n\n2013-01-03\n0.00\n0.00\n0.00\n2.00\n\n\n2013-01-04\n0.00\n0.00\n3.00\n3.00\n\n\n2013-01-05\n0.00\n0.00\n3.00\n9.00\n\n\n\n\n\n\n\n\ntrain_step=make_multistep_target(train_step[\"sales\"], 3)\n\n\ntrain_step=train_step.stack(['family', 'store_nbr']) # family, store_nbr ã‚’ index ã«æˆ»ã™\n\n\ntrain_step=train_step.dropna()\n\n\ntrain_step.head()\n\n\n\n\n\n\n\n\n\n\ny_step_1\ny_step_2\ny_step_3\n\n\ndate\nfamily\nstore_nbr\n\n\n\n\n\n\n\n2013-01-01\n1\n1\n0.00\n0.00\n0.00\n\n\n2\n0.00\n0.00\n0.00\n\n\n2\n1\n0.00\n2.00\n0.00\n\n\n2\n0.00\n3.00\n2.00\n\n\n2013-01-02\n1\n1\n0.00\n0.00\n0.00\n\n\n\n\n\n\n\n\nFEATURES=[\"onpromotion\",]\n\ntrain_feature_df=train[KEY+FEATURES]\n\n\ntrain_feature_df=train_feature_df.set_index(['family', 'store_nbr','date', ])\n\n\ntrain_with_step_df=train_feature_df.join(train_step, how='inner')\n\n\nX=train_with_step_df[FEATURES]\ny=train_with_step_df[[c for c in train_with_step_df.columns if c.startswith(\"y_step\")]]\n\n\nX\n\n\n\n\n\n\n\n\n\n\nonpromotion\n\n\nfamily\nstore_nbr\ndate\n\n\n\n\n\n1\n1\n2013-01-01\n0.00\n\n\n2\n2013-01-01\n0.00\n\n\n2\n1\n2013-01-01\n0.00\n\n\n2\n2013-01-01\n0.00\n\n\n1\n1\n2013-01-02\n0.00\n\n\n...\n...\n...\n...\n\n\n2\n2\n2017-08-12\n1.00\n\n\n1\n1\n2017-08-13\n0.00\n\n\n2\n2017-08-13\n0.00\n\n\n2\n1\n2017-08-13\n0.00\n\n\n2\n2017-08-13\n1.00\n\n\n\n\n6728 rows Ã— 1 columns\n\n\n\n\ny\n\n\n\n\n\n\n\n\n\n\ny_step_1\ny_step_2\ny_step_3\n\n\nfamily\nstore_nbr\ndate\n\n\n\n\n\n\n\n1\n1\n2013-01-01\n0.00\n0.00\n0.00\n\n\n2\n2013-01-01\n0.00\n0.00\n0.00\n\n\n2\n1\n2013-01-01\n0.00\n2.00\n0.00\n\n\n2\n2013-01-01\n0.00\n3.00\n2.00\n\n\n1\n1\n2013-01-02\n0.00\n0.00\n0.00\n\n\n...\n...\n...\n...\n...\n...\n\n\n2\n2\n2017-08-12\n7.00\n10.00\n7.00\n\n\n1\n1\n2017-08-13\n0.00\n0.00\n0.00\n\n\n2\n2017-08-13\n0.00\n0.00\n0.00\n\n\n2\n1\n2017-08-13\n1.00\n6.00\n4.00\n\n\n2\n2017-08-13\n10.00\n7.00\n9.00\n\n\n\n\n6728 rows Ã— 3 columns\n\n\n\n\n\nãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’\nä¸Šã®æƒ…å ±ã§å­¦ç¿’ã—ã¦ã¿ã‚‹\n\nfrom sklearn.multioutput import RegressorChain\nfrom sklearn.linear_model import LinearRegression\n# from xgboost import XGBRegressor\n\nmodel = RegressorChain(base_estimator=LinearRegression())\n\n\nmodel.fit(X, y)\n\nRegressorChain(base_estimator=LinearRegression())In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.RegressorChain?Documentation for RegressorChainiFittedRegressorChain(base_estimator=LinearRegression()) base_estimator: LinearRegressionLinearRegression() LinearRegression?Documentation for LinearRegressionLinearRegression() \n\n\n\npred=model.predict(X)\n\n\npred.shape\n\n(6728, 3)"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html",
    "href": "posts/2024-06-17_sqlcontest-01-10.html",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "",
    "text": "SQL ã® Window é–¢æ•°ã®ç·´ç¿’ã®ãŸã‚ SQL ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ ã®å•é¡Œ4 ã‚’è§£ã„ã¦ã„ãã€‚\næ³¨æ„"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬1å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬1å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬1å› å•é¡Œ4",
    "text": "ç¬¬1å› å•é¡Œ4\nRANK ã‚’ä½¿ã†å•é¡Œ\nwith t1 as (select pf_code\n                 , NATION_CODE\n                 , amt\n                 , rank() over (\n        partition by pf_code\n        order by amt desc,NATION_CODE\n        ) as rnk\n            from FOREIGNER fo\n            where NATION_CODE &lt;&gt; '113')\n\nselect t1.pf_code as 'éƒ½é“åºœçœŒã‚³ãƒ¼ãƒ‰'\n     , pf.PF_NAME as 'éƒ½é“åºœçœŒå'\n     , max(case when t1.rnk == 1 then na.NATION_NAME else '' end) '1ä½ å›½å'\n     , max(case when t1.rnk == 1 then t1.amt else 0 end) '1ä½ äººæ•°'\n     , max(case when t1.rnk == 2 then na.NATION_NAME else '' end) '2ä½ å›½å'\n     , max(case when t1.rnk == 2 then t1.amt else 0 end) '2ä½ äººæ•°'\n     , max(case when t1.rnk == 3 then na.NATION_NAME else '' end) '3ä½ å›½å'\n     , max(case when t1.rnk == 3 then t1.amt else 0 end) '3ä½ äººæ•°'\n     , max(tot.amt) 'åˆè¨ˆäººæ•°'\nfrom t1\n     join PREFECTURE pf on t1.PF_CODE = pf.PF_CODE\n     join NATIONALITY na on t1.NATION_CODE = na.NATION_CODE\n     join (select pf_code, sum(amt) amt\n           from FOREIGNER\n           where NATION_CODE &lt;&gt; '113'\n           group by PF_CODE) tot on tot.PF_CODE = t1.pf_code\n\nwhere rnk &lt;= 3\n\ngroup by t1.PF_CODE\norder by 9 desc, 1"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬2å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬2å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬2å› å•é¡Œ4",
    "text": "ç¬¬2å› å•é¡Œ4\næ¨ªæŒã¡ãƒ‡ãƒ¼ã‚¿ã‚’ç¸¦æŒã¡ã«ã™ã‚‹å•é¡Œã€‚\nWITH t1 AS (SELECT CASE no\n                       WHEN 0 THEN 'å°å­¦æ ¡'\n                       WHEN 1 THEN 'ä¸­å­¦æ ¡'\n                       WHEN 2 THEN 'é«˜æ ¡'\n                       WHEN 3 THEN 'çŸ­å¤§'\n                       WHEN 4 THEN 'å¤§å­¦'\n                       ELSE 'å¤§å­¦é™¢'\n    END KIND\n                 , CASE no\n                       WHEN 0 THEN ELEMENTARY\n                       WHEN 1 THEN MIDDLE\n                       WHEN 2 THEN HIGH\n                       WHEN 3 THEN JUNIOR_CLG\n                       WHEN 4 THEN COLLEGE\n                       ELSE GRADUATE\n        END AMT\n                 , no\n                 , SURVEY_YEAR\n                 , PF_CODE\n            FROM ENROLLMENT_STATUS\n               , (WITH SEQ AS (SELECT 0 AS no UNION ALL SELECT no + 1 AS no FROM SEQ WHERE no + 1 &lt; 6) SELECT * FROM seq) seq\n\n            WHERE SURVEY_YEAR = 2020)\nSELECT SURVEY_YEAR SV_YEAR\n     , PF.PF_NAME PREFECTURE\n     , KIND KIND\n     , SUM(AMT) AS AMT\nFROM t1\n     JOIN PREFECTURE PF ON PF.PF_CODE = t1.PF_CODE\nWHERE t1.amt IS NOT NULL\nGROUP BY SURVEY_YEAR, PF.PF_NAME, KIND, no\nORDER BY PF.PF_CODE, no"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬3å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬3å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬3å› å•é¡Œ4",
    "text": "ç¬¬3å› å•é¡Œ4\nã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å¾—ç‚¹ã¨é †ä½ã‚’æ±‚ã‚ã‚‹å•é¡Œã€‚å•é¡Œæ–‡é•·ã™ãã€‚\nãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ 2 ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä¸å‚™ã§ã€\nENTRIES.CONTEST_ID = 2 ã§ã‚ã‚‹ãŒ SUBMISSIONS.CONTEST_ID ãŒ 2 ã§ãªã„ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã‚‹ã€‚\nWITH t1 AS (SELECT sub.*\n                 , ent.STARTED_AT\n            FROM ENTRIES ent\n                 JOIN SUBMISSIONS sub ON sub.ENTRY_ID = ent.ENTRY_ID\n            WHERE ent.CONTEST_ID = 2\n              AND sub.CONTEST_ID = 2)\n   , ac AS (SELECT entry_id\n                 , SUM(point) pt\n                 , MAX(STRFTIME('%s', SUBMITTED_AT)) - MAX(STRFTIME('%s', STARTED_AT)) tdiff\n            FROM t1\n            WHERE STATUS = 'AC'\n            GROUP BY ENTRY_ID)\n   , wa AS (SELECT t1.entry_id\n                 , COUNT(*) cnt\n            FROM t1\n                 JOIN (SELECT ENTRY_ID, PROBLEM_ID, SUBMITTED_AT\n                       FROM t1\n                       WHERE STATUS = 'AC') tac\n                      ON t1.ENTRY_ID = tac.ENTRY_ID\n                          AND t1.PROBLEM_ID = tac.PROBLEM_ID\n                          AND t1.SUBMITTED_AT &lt;= tac.SUBMITTED_AT\n            WHERE t1.STATUS &lt;&gt; 'AC'\n            GROUP BY t1.ENTRY_ID)\nSELECT RANK() OVER (\n    ORDER BY t.POINT DESC,t.EX_TIME\n    ) AS RANK\n     , t.*\nFROM (SELECT ent.USER_ID\n           , ac.pt AS POINT\n           , ac.tdiff + 300 * (IFNULL(wa.cnt, 0)) EX_TIME\n           , IFNULL(wa.cnt, 0) WRONG_ANS\n      FROM ac\n           LEFT JOIN wa ON ac.ENTRY_ID = wa.ENTRY_ID\n           JOIN ENTRIES ent ON ent.ENTRY_ID = ac.ENTRY_ID) t"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬4å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬4å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬4å› å•é¡Œ4",
    "text": "ç¬¬4å› å•é¡Œ4\nå­˜åœ¨ã—ãªã„æ—¥ä»˜ã‚’ã†ã¾ãä½œã‚‹å•é¡Œã€‚\né€£ç•ªã‚’ä½œã‚‹ã‚³ãƒ¼ãƒ‰(SEQ ã¨ã—ã¦ã„ã‚‹éƒ¨åˆ†) ã‚’æŒã£ã¦ã„ã‚‹ã¨ãªã«ã‹ã¨ä¾¿åˆ©ã€‚\nWITH SEQ AS (SELECT 0 AS no UNION ALL SELECT no + 1 AS no FROM SEQ WHERE no + 1 &lt; 31)\n   , t1 AS (SELECT no, DATE('2022-08-01', '+' || no || ' day') AS dt FROM seq)\nSELECT dt AS REGIST_DATE\n     , SUBSTR('æœˆç«æ°´æœ¨é‡‘åœŸæ—¥', (no % 7) + 1, 1) AS WK\n     , IFNULL(COUNT(us.USER_CODE), 0) AS TOTAL\nFROM t1\n     LEFT JOIN\n     USERS AS us ON DATE(us.CONFIRMED_AT) == t1.dt\n         AND us.VALID_FLG = '1'\nGROUP BY dt, no;"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬5å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬5å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬5å› å•é¡Œ4",
    "text": "ç¬¬5å› å•é¡Œ4\nä¸ãˆã‚‰ã‚ŒãŸå¼ã«å¾“ã£ã¦ç´¯ç©å’Œã‚’å–ã‚‹å•é¡Œã€‚\nWITH t1 AS (SELECT MONTHLY\n                 , NEW_MRR + mrr.EXPANSION_MRR - mrr.DOWNGRADE_MRR - mrr.CHURN_MRR AS x\n            FROM MRR_DATA mrr)\n   , month AS (SELECT DISTINCT monthly\n               FROM MRR_DATA\n               UNION ALL\n               SELECT DATE(MAX(monthly), '+1 month')\n               FROM MRR_DATA)\nSELECT m.MONTHLY YM, IFNULL(SUM(t1.x), 0) MRR\nFROM month m\n     LEFT JOIN t1 ON t1.MONTHLY &lt; m.MONTHLY\nGROUP BY m.MONTHLY\nORDER BY m.MONTHLY;"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬6å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬6å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬6å› å•é¡Œ4",
    "text": "ç¬¬6å› å•é¡Œ4\nã‚„ã‚‹ã ã‘ã®å•é¡Œã€‚\nSELECT di.DISTRICT_CODE CODE\n     , DISTRICT_NAME NAME\n     , LATITUDE LAT\n     , LONGITUDE LON\nFROM LOCATION_TBL lo\n     JOIN DISTRICT AS di ON di.DISTRICT_CODE = lo.DISTRICT_CODE\nWHERE di.DISTRICT_CODE &lt;&gt; '1101'\nORDER BY (SELECT (LATITUDE - lo.LATITUDE) * (LATITUDE - lo.LATITUDE) + (LONGITUDE - lo.LONGITUDE) * (LONGITUDE - lo.LONGITUDE) FROM LOCATION_TBL WHERE DISTRICT_CODE = '1101')\n        DESC, 1"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬7å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬7å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬7å› å•é¡Œ4",
    "text": "ç¬¬7å› å•é¡Œ4\nã“ã‚Œã‚‚ã‚„ã‚‹ã ã‘ã®å•é¡Œã€‚\nROUND, CAST ã®ä½¿ã„æ–¹ã‚’å­¦ã‚“ã ã€‚\nWITH t1 AS (SELECT ITEM_CODE, SUM(UNITPRICE * SALES_QTY) AS amt\n            FROM sales\n                 INNER JOIN SALES_DTL de ON de.sales_no = sales.SALES_NO\n            WHERE SALES_DATE BETWEEN '2023-06-01' AND '2023-06-30'\n            GROUP BY ITEM_CODE)\n   , t2 AS (SELECT t1.ITEM_CODE\n                 , SUM(t2.amt) v0\n                 , ROUND(CAST(MAX(t1.amt) AS real) / (SELECT SUM(amt) FROM t1) * 100, 1) v1\n                 , ROUND(CAST(IFNULL(SUM(t2.amt), 0) AS real) / (SELECT SUM(amt) FROM t1) * 100, 1) v2\n            FROM t1\n                 LEFT JOIN t1 t2 ON t2.amt &gt;= t1.amt\n            GROUP BY t1.ITEM_CODE)\nSELECT t1.ITEM_CODE CODE\n     , ITEM_NAME NAME\n     , t1.amt SAL_AMT\n     , t2.v0 CML_AMT\n     , t2.v1 || '%' SAL_COMP\n     , t2.v2 || '%' TTL_COMP\n     , CASE\n           WHEN t2.v2 &lt;= 40 THEN 'A'\n           WHEN t2.v2 &lt;= 80 THEN 'B'\n           ELSE 'C' END AS RANK\nFROM t1\n     JOIN t2 ON t1.ITEM_CODE = t2.ITEM_CODE\n     JOIN ITEM ON ITEM.ITEM_CODE = t2.ITEM_CODE\n\nORDER BY 3 DESC, 1 DESC"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬8å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬8å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬8å› å•é¡Œ4",
    "text": "ç¬¬8å› å•é¡Œ4\nå•é¡Œæ–‡ã«â€è¨­å®šâ€ã¨ã‚ã£ã¦ä½•ã‚’ã™ã‚‹ã®ã‹ã‚ã‹ã‚Šã«ãã„ãŒã€æ›´æ–°ã‚¯ã‚¨ãƒªã‚’å•ã‚ã‚Œã¦ã„ã‚‹ã€‚ å‰¯å•åˆã›ã‚’ä½¿ã£ãŸ UPDATE å¿˜ã‚Œã¦ã„ãŸã®ã§å‹‰å¼·ã«ãªã£ãŸã€‚\nUPDATE item SET ITEM_POPULAR_RANK=0;\nWITH t1 AS (SELECT D.ITEM_CODE\n                 , MAX(ORDER_DATE) DT\n                 , SUM(ORDER_QTY) qty\n            FROM ORDERS O\n                 JOIN ORDERS_DTL D ON D.ORDER_NO = O.ORDER_NO\n            WHERE O.ORDER_DATE BETWEEN '2023-04-01' AND '2023-06-30'\n            GROUP BY D.ITEM_CODE)\n   , t2 AS (SELECT t1.*\n                 , RANK() OVER (ORDER BY qty DESC, dt DESC,ITEM_CODE DESC\n        ) rnk\n            FROM t1)\nUPDATE item\nSET ITEM_POPULAR_RANK = t2.rnk\nFROM t2\nWHERE t2.ITEM_CODE = item.ITEM_CODE;"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬9å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬9å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬9å› å•é¡Œ4",
    "text": "ç¬¬9å› å•é¡Œ4\nNTILE ã‚’ä½¿ãˆã‚‹å•é¡Œã€‚\nã©ã®ã‚ˆã†ã«é›†è¨ˆã™ã‚‹ã‹æ‚©ã‚“ã ã€‚ NTILE ã¨ã£ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰ã‚‚ã£ã¦é›†è¨ˆã—ã¦ãŠã(ä»¥ä¸‹ã® t3 )ã¨æ¯”è¼ƒçš„æ¥½ãã†ã€‚\nWITH t1 AS (SELECT PF_CODE, TOTAL_VALUE FROM CONVENIENCE WHERE SURVEY_YEAR = 2019 AND KIND_CODE = '100')\n   , t2 AS (SELECT PF_CODE, TOTAL_VALUE te FROM CONVENIENCE WHERE SURVEY_YEAR = 2019 AND KIND_CODE = '150')\n   , t3 AS (SELECT no, SUM(sal) sal, SUM(te) te\n            FROM (SELECT t1.TOTAL_VALUE sal, t2.te, NTILE(10) OVER ( ORDER BY t1.TOTAL_VALUE DESC, t2.te, t1.PF_CODE) NO\n                  FROM t1\n                       LEFT JOIN t2 ON t1.PF_CODE = t2.PF_CODE) t\n            GROUP BY t.no)\n   , t4 AS (SELECT t3.no, SUM(tmp.sal) s\n            FROM t3\n                 LEFT JOIN t3 AS tmp ON t3.no &gt;= tmp.no\n            GROUP BY t3.no)\nSELECT t3.no NO\n     , t3.sal TTL_SAL\n     , ROUND(CAST(t3.sal AS real) / tot.val * 100, 1) PER_SAL\n     , ROUND(CAST(t4.s AS real) / tot.val * 100, 1) CUM_SAL\n     , FLOOR(CAST(t3.sal AS real) / t3.te) AVG_SAL\nFROM t3\n     LEFT JOIN t4 ON t3.no = t4.no\n   , (SELECT SUM(sal) val FROM t3) tot\nGROUP BY t3.no\nORDER BY t3.no\n;"
  },
  {
    "objectID": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬10å›-å•é¡Œ4",
    "href": "posts/2024-06-17_sqlcontest-01-10.html#ç¬¬10å›-å•é¡Œ4",
    "title": "SQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)",
    "section": "ç¬¬10å› å•é¡Œ4",
    "text": "ç¬¬10å› å•é¡Œ4\nã„ã‚ã„ã‚ã‚„ã‚Šæ–¹ã¯ã‚ã‚Šãã†ãªå•é¡Œã€‚ä»Šå›ã¯ UNION ALL ã§å…¥ã‚Œå­ã«ã—ã¦1ã¤å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã™ã‚‹ã‚ˆã†ã«ã—ãŸã€‚\nä»–ã«ã¯ RANK ã‚’ä½¿ã£ã¦ timestamp é †ã«ãƒ©ãƒ³ã‚¯ã‚’ã¨ã‚Šã€STEP {i} ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã¨ã“ã‚ã¾ã§ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ãªã©ãŒè€ƒãˆã‚‰ã‚Œã‚‹ã€‚\nSTEP5 ã®ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã§ã‚‚ STEP5 | 0 ã¨è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã« SEQ ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ã†ã“ã¨ã«æ³¨æ„ã€‚\nWITH t1 AS (SELECT lo.SESSION_ID, lo.PROCESS_ID, lo.EX_TIMESTAMP, MAX(lo2.EX_TIMESTAMP) pre_t\n            FROM PROCESS_LOG lo\n                 LEFT JOIN PROCESS_LOG lo2 ON lo.SESSION_ID = lo2.SESSION_ID AND lo.EX_TIMESTAMP &gt; lo2.EX_TIMESTAMP\n            GROUP BY lo.SESSION_ID, lo.PROCESS_ID, lo.EX_TIMESTAMP)\n   , t2 AS (SELECT t1.*, 1 step\n            FROM t1\n            WHERE PROCESS_ID = 'STEP1'\n              AND pre_t IS NULL\n            UNION ALL\n            SELECT t1.*, t2.step + 1\n            FROM t1\n                 JOIN t2 ON t1.SESSION_ID = t2.SESSION_ID AND t1.PROCESS_ID = 'STEP' || (t2.step + 1) AND t1.pre_t = t2.EX_TIMESTAMP\n            WHERE step &lt; 5)\n   , seq AS (SELECT 1 AS no UNION ALL SELECT no + 1 AS no FROM SEQ WHERE no + 1 &lt;= 5)\nSELECT 'STEP' || seq.no PROCESS, COUNT(session_id) CNT\nFROM seq\n     LEFT JOIN t2 ON 'STEP' || seq.no = t2.PROCESS_ID\nGROUP BY seq.no\nORDER BY 1"
  },
  {
    "objectID": "posts/2024-08-16_gauss_sec3_param.html",
    "href": "posts/2024-08-16_gauss_sec3_param.html",
    "title": "ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ 3ç«  ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å®š",
    "section": "",
    "text": "å‰å› ã‹ã‚‰ã®ç¶šã\nãƒ†ã‚­ã‚¹ãƒˆ 3.5 ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å®šã‚’ã‚„ã£ã¦ã¿ã‚‹ã€‚\ntrainãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦å¯¾æ•°å°¤åº¦ãŒæœ€å¤§ã«ãªã‚‹ã‚ˆã†ãª \\(\\theta\\) ã‚’æ¢ç´¢ã™ã‚‹ã€‚\nå¯¾æ•°å°¤åº¦ã®å¼ã¯ (3.92) ã® \\(-\\log |K_\\theta| - y^T K^{-1}_\\theta y\\) ã€‚\nå‰å›åŒæ§˜ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãªã©ã¯ä»¥ä¸‹ã®è¨˜äº‹ã‹ã‚‰å€Ÿã‚Šã¦ã„ã‚‹ã€‚\nã€ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ã€Pythonã®numpyã ã‘ã§å®Ÿè£…ã™ã‚‹ã‚¬ã‚¦ã‚¹éç¨‹å›å¸° #æ©Ÿæ¢°å­¦ç¿’ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã‚·ãƒªãƒ¼ã‚º - Qiita\n# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ\n\nimport numpy as np\nnp.random.seed(seed=9973)\n\n\n# å…ƒãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ\nn=100\ndata_x = np.linspace(0, 4*np.pi, n)\ndata_y = 2*np.sin(data_x) + 3*np.cos(2*data_x) + 5*np.sin(2/3*data_x) + np.random.randn(len(data_x))\n\n# ä¿¡å·ã‚’æ¬ æã•ã›ã¦éƒ¨åˆ†çš„ãªã‚µãƒ³ãƒ—ãƒ«ç‚¹ã‚’å¾—ã‚‹\nmissing_value_rate = 0.15\nsample_index = np.sort(np.random.choice(np.arange(n), int(n*missing_value_rate), replace=False))\n\n# ãƒ‡ãƒ¼ã‚¿ã®å®šç¾©\nxtrain = np.copy(data_x[sample_index])\nytrain = np.copy(data_y[sample_index])\n\nxtest = np.copy(data_x)\n# ã‚«ãƒ¼ãƒãƒ«\n\nimport numpy.matlib\ndef kgauss(X,theta_1,theta_2,theta_3):\n    \"\"\"\n    RBF kernel\n    å›³ 3.18 ã®å®Ÿè£…\n    \"\"\"\n    N=len(X)\n    X=X.reshape(N,-1)\n    X=X.T # D * N æ¬¡å…ƒã«\n    \n    z=(X**2).sum(axis=0).reshape(1,N)\n    K = numpy.matlib.repmat(z.T,1,N)+ numpy.matlib.repmat(z,N,1) -np.dot(X.T,X)*2.\n    return theta_1*np.exp(-K/theta_2)+theta_3*np.identity(N)"
  },
  {
    "objectID": "posts/2024-08-16_gauss_sec3_param.html#optuna-ã‚’ä½¿ã£ã¦-theta-ã‚’æ¢ç´¢ã™ã‚‹",
    "href": "posts/2024-08-16_gauss_sec3_param.html#optuna-ã‚’ä½¿ã£ã¦-theta-ã‚’æ¢ç´¢ã™ã‚‹",
    "title": "ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ 3ç«  ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å®š",
    "section": "optuna ã‚’ä½¿ã£ã¦ \\(\\theta\\) ã‚’æ¢ç´¢ã™ã‚‹",
    "text": "optuna ã‚’ä½¿ã£ã¦ \\(\\theta\\) ã‚’æ¢ç´¢ã™ã‚‹\n\ndef _objective(theta_1,theta_2,theta_3):\n    \"\"\" å¯¾æ•°å°¤åº¦é–¢æ•° \"\"\"\n    y=ytrain\n    x=xtrain\n    K=kgauss(xtrain,theta_1,theta_2,theta_3)\n    det_K=np.linalg.det(K)\n    inv_K=np.linalg.inv(K)\n    return -np.log(det_K)-np.dot(y.T,np.dot(inv_K,y))\n\n\n# optuna ã§æ¢ç´¢\n\nimport optuna\noptuna.logging.disable_default_handler()\n \ndef objective(trial):\n    theta_1 = trial.suggest_float(\"theta_1\", 1e-10, 30)\n    theta_2 = trial.suggest_float(\"theta_2\", 1e-10, 30)\n    theta_3 = trial.suggest_float(\"theta_3\", 1e-10, 30)\n    return _objective(theta_1,theta_2,theta_3)\n\n \nstudy = optuna.create_study(direction=\"maximize\")\n\nstudy.optimize(objective, n_trials=300)\nprint(study.best_trial)\n\nFrozenTrial(number=185, state=1, values=[-39.02225822902864], datetime_start=datetime.datetime(2024, 8, 15, 20, 26, 10, 299349), datetime_complete=datetime.datetime(2024, 8, 15, 20, 26, 10, 312097), params={'theta_1': 15.162762907400607, 'theta_2': 1.9226918374007205, 'theta_3': 0.463028699778022}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={'theta_1': FloatDistribution(high=30.0, log=False, low=1e-10, step=None), 'theta_2': FloatDistribution(high=30.0, log=False, low=1e-10, step=None), 'theta_3': FloatDistribution(high=30.0, log=False, low=1e-10, step=None)}, trial_id=185, value=None)\n\n\n\nprint(study.best_params)\n\n{'theta_1': 15.162762907400607, 'theta_2': 1.9226918374007205, 'theta_3': 0.463028699778022}"
  },
  {
    "objectID": "posts/2024-08-16_gauss_sec3_param.html#plot",
    "href": "posts/2024-08-16_gauss_sec3_param.html#plot",
    "title": "ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ 3ç«  ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å®š",
    "section": "plot",
    "text": "plot\næ¨å®šã—ãŸ \\(\\theta\\) ã‚’ä½¿ã£ã¦æç”»ã™ã‚‹ã€‚\n\nfrom matplotlib import pyplot as plt\n%matplotlib inline\n\ndef visualize(data_x,data_y,xtest,sample_index,mu,var,title):\n    plt.figure(figsize=(12, 5))\n    plt.title(title, fontsize=20)\n    \n    # å…ƒã®ä¿¡å·\n    plt.plot(data_x, data_y, 'x', color='green', label='correct signal')\n    # éƒ¨åˆ†çš„ãªã‚µãƒ³ãƒ—ãƒ«ç‚¹\n    plt.plot(data_x[sample_index], data_y[sample_index], 'o', color='red', label='sample dots')\n    \n    # åˆ†æ•£ã‚’æ¨™æº–åå·®ã«å¤‰æ›\n    std = np.sqrt(var)\n    \n    # ã‚¬ã‚¦ã‚¹éç¨‹ã§æ±‚ã‚ãŸå¹³å‡å€¤ã‚’ä¿¡å·åŒ–\n    plt.plot(xtest, mu, color='blue', label='mean by Gaussian process')\n    # åˆ†æ•£\n    plt.fill_between(xtest, mu + 2*std, mu - 2*std, alpha=.2, color='blue', label= 'standard deviation by Gaussian process')\n    \n    plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left', borderaxespad=0, fontsize=12)\n    plt.show()\n\n\ndef predict(xtrain,ytrain,xtest,theta_1,theta_2,theta_3):\n    \"\"\"\n    ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°\n    \"\"\"\n    ytrain=ytrain.copy()\n\n    N = len(xtrain)\n    M = len(xtest)\n    \n    # ã¾ã¨ã‚ã¦ã‚«ãƒ¼ãƒãƒ«è¨ˆç®—\n    xtrain=xtrain.reshape(N,-1)\n    xtest=xtest.reshape(M,-1)\n\n    # å›³3.15 ã®ã¨ãŠã‚Šè¡Œåˆ—ã‚’åˆ†å‰²\n    X=np.vstack([xtrain, xtest])\n    X = kgauss(X,theta_1,theta_2,theta_3)\n    \n    u, b=np.split(X,[N],0)\n    K, k_=np.split(u,[N],1)\n    k_t, k__=np.split(b,[N],1)\n    \n    assert k__.shape==(M,M)\n\n    inv_K=np.linalg.inv(K)\n    yy = np.dot(inv_K, ytrain)\n    \n    mu=np.dot(k_t,yy)\n    var=k__-np.dot(np.dot(k_t,inv_K),k_)\n    var=np.diag(var) # å¯¾è§’æˆåˆ†ã®å–å¾—\n    return mu, var\n\n\nmu,var=predict(xtrain,ytrain,xtest,**study.best_params)\n\n\nvisualize(data_x,data_y,xtest,sample_index,mu,var,'æ¨å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å›å¸°')\n\n\n\n\n\n\n\n\nãƒ†ã‚­ã‚¹ãƒˆã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦æç”»ã—ã¦æ¯”è¼ƒã—ã¦ã¿ã‚‹ã€‚\n\nmu,var=predict(xtrain,ytrain,xtest,1.0,0.4,0.1)\nvisualize(data_x,data_y,xtest,sample_index,mu,var,'ãƒ†ã‚­ã‚¹ãƒˆã¨åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã§å›å¸°')"
  },
  {
    "objectID": "posts/2024-08-14_gauss_sec3.html",
    "href": "posts/2024-08-14_gauss_sec3.html",
    "title": "ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ 3ç«  ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°",
    "section": "",
    "text": "ã€ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ã€ (è¬›è«‡ç¤¾) ã®3 ç« ã‚’èª­ã‚“ã ã®ã§ã€ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ã®éƒ¨åˆ†ã‚’å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã«ã—ã¦ã¿ã‚‹ã€‚"
  },
  {
    "objectID": "posts/2024-08-14_gauss_sec3.html#å›³3.17-ã®åŸºæœ¬ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè£…",
    "href": "posts/2024-08-14_gauss_sec3.html#å›³3.17-ã®åŸºæœ¬ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè£…",
    "title": "ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ 3ç«  ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°",
    "section": "å›³3.17 ã®åŸºæœ¬ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè£…",
    "text": "å›³3.17 ã®åŸºæœ¬ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè£…\nä»¥ä¸‹ã® Qiita è¨˜äº‹ã®å®Ÿè£…ã‚’å€Ÿã‚Šã¦ã€ä¸€éƒ¨å¤‰æ›´ã—ãŸã€‚\nã€ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ã€Pythonã®numpyã ã‘ã§å®Ÿè£…ã™ã‚‹ã‚¬ã‚¦ã‚¹éç¨‹å›å¸° #æ©Ÿæ¢°å­¦ç¿’ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã‚·ãƒªãƒ¼ã‚º - Qiita\næ³¨æ„)ã“ã®è¨˜äº‹ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã€Œå†…ç©ã¯ãƒ‰ãƒƒãƒˆã§è¨ˆç®—ã€ã¨ã‚³ãƒ¡ãƒ³ãƒˆã•ã‚Œã¦ã„ã‚‹éƒ¨åˆ†ãŒã‚ã‚‹ãŒã€å†…ç©ã§ã¯ãªãè¡Œåˆ—ç©ã€‚\n\nimport numpy as np\nnp.random.seed(seed=9973)\n\n# å…ƒãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ\nn=100\ndata_x = np.linspace(0, 4*np.pi, n)\ndata_y = 2*np.sin(data_x) + 3*np.cos(2*data_x) + 5*np.sin(2/3*data_x) + np.random.randn(len(data_x))\n\n# ä¿¡å·ã‚’æ¬ æã•ã›ã¦éƒ¨åˆ†çš„ãªã‚µãƒ³ãƒ—ãƒ«ç‚¹ã‚’å¾—ã‚‹\nmissing_value_rate = 0.15\nsample_index = np.sort(np.random.choice(np.arange(n), int(n*missing_value_rate), replace=False))\n\n# ãƒ‡ãƒ¼ã‚¿ã®å®šç¾©\nxtrain = np.copy(data_x[sample_index])\nytrain = np.copy(data_y[sample_index])\n\nxtest = np.copy(data_x)\n\n\nfrom matplotlib import pyplot as plt\n%matplotlib inline\n\nplt.figure(figsize=(12, 5))\nplt.title('signal data', fontsize=20)\n\n# å…ƒã®ä¿¡å·\nplt.plot(data_x, data_y, 'x', color='green', label='correct signal')\n\n# éƒ¨åˆ†çš„ãªã‚µãƒ³ãƒ—ãƒ«ç‚¹\nplt.plot(data_x[sample_index], data_y[sample_index], 'o', color='red', label='sample dots')\n\nplt.legend(bbox_to_anchor=(1.05, 1), loc='upper left', borderaxespad=0, fontsize=12)\nplt.show()\n\n\n\n\n\n\n\n\n\ndef RBF(x,x2,theta1,theta2,theta3,i_eq_j=False):\n    \"\"\"RBF kernel\"\"\"\n    if i_eq_j:\n        d=theta3\n    else:\n        d=0.\n    return theta1 * np.exp(-(x-x2)**2/theta2)+d\n    \n\n\ndef calc(xtrain,ytrain,xtest,kernel=RBF):\n    \"\"\"ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ã®è¨ˆç®— å›³ 3.17\"\"\"\n    # å¹³å‡\n    mu = []\n    # åˆ†æ•£\n    var = []\n\n    # å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤\n    theta_1 = 16.\n    theta_2 = 2.\n    theta_3 = 0.34\n\n    N = len(xtrain)\n    K = np.zeros((N, N))\n    \n    for x in range(N):\n        for x_prime in range(N):\n            K[x, x_prime] = kernel(xtrain[x], xtrain[x_prime], theta_1, theta_2, theta_3,x==x_prime)\n            \n    inv_K=np.linalg.inv(K)\n    yy = np.dot(inv_K, ytrain)\n\n    M = len(xtest)\n    for test_i in range(M):\n        k = np.zeros((N,))\n        for x in range(N):\n            k[x] = kernel(xtrain[x], xtest[test_i], theta_1, theta_2, theta_3)\n\n        s = kernel(xtest[test_i], xtest[test_i], theta_1, theta_2, theta_3)\n        mu.append(np.dot(k, yy))\n        kK_ = np.dot(k, inv_K)\n        var.append(s - np.dot(kK_, k.T))\n    return mu,var\n\n\nmu,var=calc(xtrain,ytrain,xtest)\n\n\ndef visualize(data_x,data_y,xtest,sample_index,mu,var):\n    plt.figure(figsize=(12, 5))\n    plt.title('signal prediction by Gaussian process', fontsize=20)\n    \n    # å…ƒã®ä¿¡å·\n    plt.plot(data_x, data_y, 'x', color='green', label='correct signal')\n    # éƒ¨åˆ†çš„ãªã‚µãƒ³ãƒ—ãƒ«ç‚¹\n    plt.plot(data_x[sample_index], data_y[sample_index], 'o', color='red', label='sample dots')\n    \n    # åˆ†æ•£ã‚’æ¨™æº–åå·®ã«å¤‰æ›\n    std = np.sqrt(var)\n    \n    # ã‚¬ã‚¦ã‚¹éç¨‹ã§æ±‚ã‚ãŸå¹³å‡å€¤ã‚’ä¿¡å·åŒ–\n    plt.plot(xtest, mu, color='blue', label='mean by Gaussian process')\n    # åˆ†æ•£\n    plt.fill_between(xtest, mu + 2*std, mu - 2*std, alpha=.2, color='blue', label= 'standard deviation by Gaussian process')\n    \n    plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left', borderaxespad=0, fontsize=12)\n    plt.show()\n\n\nvisualize(data_x,data_y,xtest,sample_index,mu,var)"
  },
  {
    "objectID": "posts/2024-08-14_gauss_sec3.html#è¡Œåˆ—æ¼”ç®—ã«å¤‰æ›´",
    "href": "posts/2024-08-14_gauss_sec3.html#è¡Œåˆ—æ¼”ç®—ã«å¤‰æ›´",
    "title": "ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ 3ç«  ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°",
    "section": "è¡Œåˆ—æ¼”ç®—ã«å¤‰æ›´",
    "text": "è¡Œåˆ—æ¼”ç®—ã«å¤‰æ›´\nfor æ–‡ã§å‡¦ç†ã—ã¦ã„ã‚‹ç®‡æ‰€ã‚’è¡Œåˆ—ã®æ¼”ç®—ã«å¤‰æ›´ã™ã‚‹ã€‚\nãƒ†ã‚­ã‚¹ãƒˆ å›³ 3.18ã€å…¬å¼ 3.8 ã‚ãŸã‚Šã‚’ä½¿ã†ã€‚\n\nimport numpy.matlib\ndef kgauss(X,theta_1,theta_2,theta_3):\n    \"\"\"\n    å›³ 3.18 ã®å®Ÿè£…\n    å¼•æ•°åã¯ä¸Šã® RBF é–¢æ•°ã«åˆã‚ã›ãŸ\n    \"\"\"\n    N=len(X)\n    X=X.reshape(N,-1)\n    X=X.T # D * N æ¬¡å…ƒã«\n    \n    z=(X**2).sum(axis=0).reshape(1,N)\n    K = numpy.matlib.repmat(z.T,1,N)+ numpy.matlib.repmat(z,N,1) -np.dot(X.T,X)*2.\n    return theta_1*np.exp(-K/theta_2)+theta_3*np.identity(N)\n\n\ndef calc2(xtrain,ytrain,xtest):\n    \"\"\"\n    å›³3.15 ã‚„å…¬å¼ 3.8 ã‚’ä½¿ã£ã¦ foræ–‡ã‚’ä½¿ã‚ãšã«è¨ˆç®—ã™ã‚‹\n    ã¾ãŸã€ train ãƒ‡ãƒ¼ã‚¿ã®å¹³å‡å€¤ãŒ 0 ã§ãªã„å ´åˆã«å¯¾å¿œã™ã‚‹ãŸã‚ã€ y ã®å¹³å‡å€¤ã‚’ 0 ã«æ­£è¦åŒ–ã—ã¦ã‹ã‚‰è¨ˆç®—ã—ã¦ã„ã‚‹\n    \"\"\"\n    \n    # å¹³å‡0ã«æ­£è¦åŒ–ã™ã‚‹ã€‚ y_mu ã¯æœ€å¾Œã« mu ã«åŠ ç®—ã™ã‚‹\n    ytrain=ytrain.copy()\n    y_mu=ytrain.mean()\n    ytrain-=y_mu\n  \n    # å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤\n    theta_1 = 16.\n    theta_2 = 2.\n    theta_3 = 0.34\n\n    N = len(xtrain)\n    M = len(xtest)\n    \n    # ã¾ã¨ã‚ã¦ã‚«ãƒ¼ãƒãƒ«è¨ˆç®—\n    xtrain=xtrain.reshape(N,-1)\n    xtest=xtest.reshape(M,-1)\n\n    # å›³3.15 ã®ã¨ãŠã‚Šè¡Œåˆ—ã‚’åˆ†å‰²\n    X=np.vstack([xtrain, xtest])\n    X = kgauss(X,theta_1,theta_2,theta_3)\n    \n    u, b=np.split(X,[N],0)\n    K, k_=np.split(u,[N],1)\n    k_t, k__=np.split(b,[N],1)\n    \n    assert k__.shape==(M,M)\n\n    inv_K=np.linalg.inv(K)\n    yy = np.dot(inv_K, ytrain)\n    \n    mu=np.dot(k_t,yy)\n    var=k__-np.dot(np.dot(k_t,inv_K),k_)\n    return mu+y_mu, var\n\n\nmu,var=calc2(xtrain,ytrain,xtest)\nvar=np.diag(var) # å¯¾è§’æˆåˆ†ã®å–å¾—\nprint(mu[:5])\nprint(var[:5])\n\n[-0.55131748 -0.53446571 -0.48757389 -0.40223414 -0.26996228]\n[13.46226381 12.46070803 11.28034711  9.95007999  8.51800331]\n\n\n\nvisualize(data_x,data_y,xtest,sample_index,mu,var)\n\n\n\n\n\n\n\n\nä¸Šã®çµæœã¨ã»ã¼åŒã˜çµæœãŒå¾—ã‚‰ã‚Œã¦ã„ã‚‹ã€‚\n\ny ã®å¹³å‡å€¤ãŒ 0 ã§ãªã„å ´åˆã®ç¢ºèª\nãƒ†ã‚­ã‚¹ãƒˆã«è¨˜è¼‰ã‚ã‚‹ã‚ˆã†ã«ã€ y ã®å¹³å‡å€¤ã‚’ã‚ã‚‰ã‹ã˜ã‚ 0 ã«ãªã‚‹ã‚ˆã†ã«æ­£è¦åŒ–ã™ã‚‹å‡¦ç†ã‚’åŠ ãˆãŸã®ã§ãã®ç¢ºèªã‚’ã™ã‚‹ã€‚\n\n# å…ƒãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ\nnp.random.seed(seed=9973)\nn=100\ndata_x = np.linspace(0, 4*np.pi, n)\n# å¹³å‡ +100 ã‚ãŸã‚Šã«ãªã‚‹ã‚ˆã†ã«\ndata_y = 2*np.sin(data_x) + 3*np.cos(2*data_x) + 5*np.sin(2/3*data_x) + np.random.randn(len(data_x)) + 100\n\nmissing_value_rate = 0.15\nsample_index = np.sort(np.random.choice(np.arange(n), int(n*missing_value_rate), replace=False))\n\n# ãƒ‡ãƒ¼ã‚¿ã®å®šç¾©\nxtrain = np.copy(data_x[sample_index])\nytrain = np.copy(data_y[sample_index])\n\nxtest = np.copy(data_x)\n\n\nmu,var=calc2(xtrain,ytrain,xtest)\nvar=np.diag(var)\n\n\nvisualize(data_x,data_y,xtest,sample_index,mu,var)"
  },
  {
    "objectID": "posts/2024-08-14_gauss_sec3.html#ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚’ç¢ºèª",
    "href": "posts/2024-08-14_gauss_sec3.html#ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚’ç¢ºèª",
    "title": "ã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ 3ç«  ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°",
    "section": "ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚’ç¢ºèª",
    "text": "ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚’ç¢ºèª\nãƒ†ã‚­ã‚¹ãƒˆ 3.2.4\nãƒ†ã‚­ã‚¹ãƒˆã®é †ç•ªã¨å‰å¾Œã™ã‚‹ãŒã€ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ã®çµæœã‚’ä½¿ã£ã¦ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°çµæœã‚‚ç¢ºèªã—ã¦ãŠãã€‚\næ±‚ã‚ãŸå¹³å‡ã€åˆ†æ•£ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦æ»‘ã‚‰ã‹ãªé–¢æ•°ã¨ãªã‚‹æ§˜å­ã‚’ç¢ºèªã™ã‚‹ã€‚\nã“ã“ã§ç”Ÿæˆã•ã‚Œã‚‹æ›²ç·šãŒã€Œäº‹å¾Œåˆ†å¸ƒã®é›²ã€ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«å‡ºåŠ›ã•ã‚ŒãŸã€Œé–¢æ•° fã€ã¨ã„ã†ã“ã¨ã«ãªã‚‹ã€‚\n\n\ndef get_cmap(name='tab10'):\n    '''Returns a function that maps each index in 0, 1, ..., n-1 to a distinct \n    RGB color; the keyword argument name must be a standard mpl colormap name.'''\n    return plt.colormaps.get_cmap(name)\n\ndef visualize2(data_x,data_y,xtest,sample_index,mu,var,ys):\n    plt.figure(figsize=(12, 5))\n    plt.title('signal prediction by Gaussian process', fontsize=20)\n        \n    # ã‚¬ã‚¦ã‚¹éç¨‹ã§æ±‚ã‚ãŸå¹³å‡å€¤ã‚’ä¿¡å·åŒ–\n    cmap = get_cmap()\n    for i,y in enumerate(ys):\n        plt.plot(xtest, y, color=cmap(i/len(ys)), label=f'mean by Gaussian process {i}')   \n        \n    # å…ƒã®ä¿¡å·\n    plt.plot(data_x, data_y, 'x', color='green', label='correct signal')\n    plt.plot(data_x[sample_index], data_y[sample_index], 'o', color='red', label='sample dots')\n    std = np.sqrt(var) \n    plt.fill_between(xtest, mu + 2*std, mu - 2*std, alpha=.2, color='blue', label= 'standard deviation by Gaussian process')\n    \n    plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left', borderaxespad=0, fontsize=12)\n    plt.show()\n\n\nrng = np.random.default_rng()\n# 5å›ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚’è¡Œã£ãŸçµæœã‚’è¡¨ç¤º\nys=[[rng.normal(a,np.sqrt(b)) for a,b in zip(mu,var)] for _ in range(5)]\nvisualize2(data_x,data_y,xtest,sample_index,mu,var,ys)"
  },
  {
    "objectID": "posts/2024-05-11-seed_everything.html",
    "href": "posts/2024-05-11-seed_everything.html",
    "title": "PyTorch å­¦ç¿’çµæœã®å†ç¾æ€§ç¢ºä¿",
    "section": "",
    "text": "Pytorch Lightning ã§å­¦ç¿’ã—ãŸã¨ãã€seed_everything ã§ä¹±æ•°å›ºå®šã™ã‚Œã°ã€åŒã˜å­¦ç¿’çµæœãŒå¾—ã‚‰ã‚Œã‚‹ã¨æ€ã£ã¦ã„ãŸãŒå®Ÿéš›ã«ã¯ãã†ã§ãªã‹ã£ãŸã€‚\nèª¿ã¹ã¦ã¿ã‚‹ã¨ã€\nã®è¨­å®šã‚‚å¿…è¦ãã†ã ã£ãŸã€‚Reproducibility â€” PyTorch 2.3 documentation\nã“ã® 2 ã¤ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€å†…éƒ¨ã§ä½¿ç”¨ã•ã‚Œã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’å›ºå®šåŒ–ã§ãã‚‹ã¨ã®ã“ã¨ã€‚\nä¸Šè¨˜å‚è€ƒã«ä»¥ä¸‹ã®é–¢æ•°ã‚’å‘¼ã¶ã“ã¨ã§ã€åŒã˜å­¦ç¿’çµæœãŒå¾—ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚"
  },
  {
    "objectID": "posts/2024-05-11-seed_everything.html#ãã®ä»–å‚è€ƒ",
    "href": "posts/2024-05-11-seed_everything.html#ãã®ä»–å‚è€ƒ",
    "title": "PyTorch å­¦ç¿’çµæœã®å†ç¾æ€§ç¢ºä¿",
    "section": "ãã®ä»–å‚è€ƒ",
    "text": "ãã®ä»–å‚è€ƒ\n\nhttps://qiita.com/north_redwing/items/1e153139125d37829d2d#cuda-convolution-benchmarking"
  },
  {
    "objectID": "posts/2024-08-16_kubo_3sho.html",
    "href": "posts/2024-08-16_kubo_3sho.html",
    "title": "ãƒ‡ãƒ¼ã‚¿è§£æã®ãŸã‚ã®çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å…¥é–€ 3ç« ã®ãƒã‚¢ã‚½ãƒ³å›å¸°",
    "section": "",
    "text": "ãƒ‡ãƒ¼ã‚¿è§£æã®ãŸã‚ã®çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å…¥é–€ 3ç« ã®ãƒã‚¢ã‚½ãƒ³å›å¸°ã‚’ã–ã£ã¨ã‚„ã£ã¦ã¿ã‚‹"
  },
  {
    "objectID": "posts/2024-08-16_kubo_3sho.html#ãƒ‡ãƒ¼ã‚¿ç¢ºèª",
    "href": "posts/2024-08-16_kubo_3sho.html#ãƒ‡ãƒ¼ã‚¿ç¢ºèª",
    "title": "ãƒ‡ãƒ¼ã‚¿è§£æã®ãŸã‚ã®çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å…¥é–€ 3ç« ã®ãƒã‚¢ã‚½ãƒ³å›å¸°",
    "section": "ãƒ‡ãƒ¼ã‚¿ç¢ºèª",
    "text": "ãƒ‡ãƒ¼ã‚¿ç¢ºèª\n\nfrom pathlib import Path\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nDATADIR=Path(\"/workdir/input/kubobook_2012/data/\")\nDATADIR\n\nPosixPath('/workdir/input/kubobook_2012/data')\n\n\n\ndf=pd.read_csv(DATADIR/\"data3a.csv\")\ndf.head()\n\n\n\n\n\n\n\n\ny\nx\nf\n\n\n\n\n0\n6\n8.31\nC\n\n\n1\n6\n9.44\nC\n\n\n2\n6\n9.50\nC\n\n\n3\n12\n9.07\nC\n\n\n4\n10\n10.16\nC\n\n\n\n\n\n\n\n\ndf.describe()\n\n\n\n\n\n\n\n\ny\nx\n\n\n\n\ncount\n100.000000\n100.000000\n\n\nmean\n7.830000\n10.089100\n\n\nstd\n2.624881\n1.008049\n\n\nmin\n2.000000\n7.190000\n\n\n25%\n6.000000\n9.427500\n\n\n50%\n8.000000\n10.155000\n\n\n75%\n10.000000\n10.685000\n\n\nmax\n15.000000\n12.400000\n\n\n\n\n\n\n\n\ncolor=['blue' if x=='C' else 'red' for x in df.f.to_list()]\nplt.scatter(df.x,df.y,c=color)"
  },
  {
    "objectID": "posts/2024-08-16_kubo_3sho.html#ãƒã‚¢ã‚½ãƒ³å›å¸°",
    "href": "posts/2024-08-16_kubo_3sho.html#ãƒã‚¢ã‚½ãƒ³å›å¸°",
    "title": "ãƒ‡ãƒ¼ã‚¿è§£æã®ãŸã‚ã®çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å…¥é–€ 3ç« ã®ãƒã‚¢ã‚½ãƒ³å›å¸°",
    "section": "ãƒã‚¢ã‚½ãƒ³å›å¸°",
    "text": "ãƒã‚¢ã‚½ãƒ³å›å¸°\nsklearn ã®ãƒã‚¢ã‚½ãƒ³å›å¸°ã‚’ä½¿ã£ã¦å›å¸°ã—ã¦ã¿ã‚‹ã€‚\nãƒã‚¢ã‚½ãƒ³å›å¸°ã¯ \\(log (\\lambda) = \\beta X\\) ã®ç·šå½¢å›å¸°ã«ãªã‚‹ã‚‰ã—ã„ã€‚(3ç« ã®å›å¸°ã¨åŒã˜ã§å¯¾æ•°ãƒªãƒ³ã‚¯é–¢æ•°ãŒä½¿ã‚ã‚Œã‚‹)\nhttps://okumuralab.org/~okumura/stat/poisson_regression.html\n\nfrom sklearn import linear_model\nclf = linear_model.PoissonRegressor()\n\n\n# NOTE: å¤šå¤‰é‡ã®å ´åˆã¯ã€ df[[\"x1\",\"x2\"]] ã®ã‚ˆã†ã«ã™ã‚‹\nclf.fit(df[[\"x\"]],df[\"y\"])\n\nPoissonRegressor()In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.Â Â PoissonRegressor?Documentation for PoissonRegressoriFittedPoissonRegressor() \n\n\n\nprint(\"beta_1:\",clf.intercept_) # bias \nprint(\"beta_2:\",clf.coef_) # ä¿‚æ•°\n\nbeta_1: 1.378219625347999\nbeta_2: [0.06714908]\n\n\n\npreds=clf.predict(df[[\"x\"]])\npreds[:5]\n\narray([6.93255517, 7.47905849, 7.50925198, 7.29552944, 7.84953464])\n\n\n\n# lambda ã‚’æ‰‹è¨ˆç®—ã—ãŸçµæœã¨ç¢ºèªã—ã¦ã¿ã‚‹\nnp.exp(df[:5][[\"x\"]]*clf.coef_[0]+clf.intercept_)\n\n\n\n\n\n\n\n\nx\n\n\n\n\n0\n6.932555\n\n\n1\n7.479058\n\n\n2\n7.509252\n\n\n3\n7.295529\n\n\n4\n7.849535\n\n\n\n\n\n\n\n\ndf[\"pred\"]=preds\n\nå¯¾æ•°å°¤åº¦è¨ˆç®—ã—ã¦ã¿ã‚‹\n\n# å°¤åº¦è¨ˆç®—ã—ã¦ã¿ã‚‹\nfrom scipy.stats import poisson\n\n\nloglike=df.apply(lambda x:np.log(poisson.pmf(x[\"y\"],x[\"pred\"])) ,axis=1).sum()\nprint(\"å¯¾æ•°å°¤åº¦:\",loglike)\n\nå¯¾æ•°å°¤åº¦: -235.41483299355457\n\n\nãƒ†ã‚­ã‚¹ãƒˆã®å€¤ã¨ã»ã¼åŒã˜å€¤ã¨ãªã£ã¦ã„ã‚‹ã€‚\nã¤ãã« lambda ã®äºˆæ¸¬ã‚’ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ã€‚\n\ncolor=['blue' if x=='C' else 'red' for x in df.f.to_list()]\n\n# lambda ã®äºˆæ¸¬å€¤ã‚’å¼•ã\nplt.scatter(df.x,df.y,c=color)\ndata_x = np.linspace(7,13,100).reshape(100,1)\nmu_=clf.predict(data_x)\nplt.plot(data_x,mu_)\n\nplt.show()\n\n/opt/conda/envs/foo/lib/python3.11/site-packages/sklearn/base.py:493: UserWarning: X does not have valid feature names, but PoissonRegressor was fitted with feature names\n  warnings.warn("
  },
  {
    "objectID": "posts/2024-08-16_kubo_3sho.html#æ–½è‚¥åŠ¹æœã®èª¬æ˜å¤‰æ•°ã‚’è¿½åŠ -3.5",
    "href": "posts/2024-08-16_kubo_3sho.html#æ–½è‚¥åŠ¹æœã®èª¬æ˜å¤‰æ•°ã‚’è¿½åŠ -3.5",
    "title": "ãƒ‡ãƒ¼ã‚¿è§£æã®ãŸã‚ã®çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å…¥é–€ 3ç« ã®ãƒã‚¢ã‚½ãƒ³å›å¸°",
    "section": "æ–½è‚¥åŠ¹æœã®èª¬æ˜å¤‰æ•°ã‚’è¿½åŠ  3.5ã€œ",
    "text": "æ–½è‚¥åŠ¹æœã®èª¬æ˜å¤‰æ•°ã‚’è¿½åŠ  3.5ã€œ\n\n# æ–½è‚¥åŠ¹æœ\ndf['d']=df.f.apply(lambda x:1 if x=='T' else 0)\n\n\nclf = linear_model.PoissonRegressor()\n# å¤šå¤‰é‡ã®å ´åˆã¯ã€ df[[\"x1\",\"x2\"]] ã®ã‚ˆã†ã«ã™ã‚‹ã ã‘ã§è‰¯ã„\nclf.fit(df[[\"x\",\"d\"]],df[\"y\"])\n\nPoissonRegressor()In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.Â Â PoissonRegressor?Documentation for PoissonRegressoriFittedPoissonRegressor() \n\n\n\nprint(\"bias:\",clf.intercept_) # bias \nprint(\"beta:\",clf.coef_) # ä¿‚æ•°\n\nbias: 1.3655409998858836\nbeta: [ 0.06925659 -0.01719852]\n\n\nå¯¾æ•°å°¤åº¦è¨ˆç®—\n\npreds=clf.predict(df[[\"x\",\"d\"]])\nloglike=np.log(poisson.pmf(df[\"y\"],preds)).sum()\nprint(\"å¯¾æ•°å°¤åº¦:\",loglike)\n\nå¯¾æ•°å°¤åº¦: -235.34390910510987\n\n\n1å¤‰æ•°ã ã‘ã®ã¨ãã®å›å¸°ã‚ˆã‚Šã‚‚ã€å°¤åº¦ãŒå°‘ã—å¢—åŠ ã—ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ããŸã€‚"
  },
  {
    "objectID": "posts/make_grid_example.html",
    "href": "posts/make_grid_example.html",
    "title": "ç”»åƒã‚°ãƒªãƒƒãƒ‰æç”»ã‚µãƒ³ãƒ—ãƒ«",
    "section": "",
    "text": "è¤‡æ•°æšã®ç”»åƒã‚’ã‚°ãƒªãƒƒãƒ‰æç”»ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚\ntorchvision ã® make_grid ã‚’ä½¿ã£ã¦æç”»ã—ã¾ã™ã€‚ make_grid\n\nimport matplotlib.pyplot as plt\nimport random\nimport numpy as np\nimport albumentations as A\nfrom albumentations.pytorch import ToTensorV2\nfrom torchvision.utils import make_grid\nimport torch\n\n\nclass CFG:\n    H=32\n    W=64\n    row=3\n\n\ndef get_tranform():\n    \"\"\"ç”»åƒã‚’ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’å¤‰ãˆãšã« CFG.H * CFG.W ã‚µã‚¤ã‚ºã«å¤‰æ›ã™ã‚‹\"\"\"\n    t = A.Compose([\n        A.LongestMaxSize(max_size=max(CFG.H,CFG.W)),\n        A.PadIfNeeded(min_height=CFG.H, min_width=CFG.W, border_mode=0, mask_value=0),\n        ToTensorV2(),\n    ])\n    return t\n\n\nç”»åƒã®ç”¨æ„\næ•°æšãƒ©ãƒ³ãƒ€ãƒ ã«å˜è‰²ç”»åƒã‚’ä½œæˆã™ã‚‹\n\ndef create_img(color,size):\n    \"\"\"å˜è‰²ç”»åƒã®ä½œæˆ\"\"\"\n    return np.array(color,dtype=np.uint8)*np.ones((*size,3), dtype=np.uint8)\n\n\nimages= [create_img([random.randint(0,255) for _ in range(3)],(20,50)) for _ in range(20)]\n\n\n\ngrid ã®ä½œæˆ\n\nt=get_tranform()\nimages=[t(image=img)['image'] for img in images]\n\n\ntmp=torch.stack(images)\n\n\nres=make_grid(tmp,3,padding=2)\n\n\n# channel ã‚’ä¸€ç•ªæœ€å¾Œã«\ngrid_image=res.permute(1,2,0).numpy()\n\n\nplt.imshow(grid_image)\n\n\n\n\n\n\n\n\n\n\nsave\n\nfrom PIL import Image\n\n\nimage=Image.fromarray(grid_image)\n\n\nimage.save(\"test.jpg\")\n\n\n\n\n\nCopyrightCopyright tamuraup. 2024. All Rights Reserved"
  },
  {
    "objectID": "posts/2024-05-09_bcewithlogitsloss_check.html",
    "href": "posts/2024-05-09_bcewithlogitsloss_check.html",
    "title": "BCEWithLogitsLoss ã®ç¢ºèª",
    "section": "",
    "text": "BCEWithLogitsLoss ã¯ãƒãƒ«ãƒãƒ©ãƒ™ãƒ«åˆ†é¡ã®ãƒ­ã‚¹ã«ä½¿ãˆã‚‹ã“ã¨ã‚’çŸ¥ã£ãŸ\nBCEWithLogitsLoss\n\nimport numpy as np\nimport torch\n\n\ntarget = torch.ones([1, 10], dtype=torch.float32)  # 10 classes, batch size = 1\n# A prediction (logit)\noutput = torch.cat([torch.full([1, 5], 1.5),torch.full([1,5],1.0)],dim=1)\ncriterion = torch.nn.BCEWithLogitsLoss(reduction='none')\ncriterion(output, target)  # -log(sigmoid(output value))\n\ntensor([[0.2014, 0.2014, 0.2014, 0.2014, 0.2014, 0.3133, 0.3133, 0.3133, 0.3133,\n         0.3133]])\n\n\n\nsigmoid=torch.sigmoid(torch.Tensor([1.0,1.5]))\ntorch.log(sigmoid)\n\ntensor([-0.3133, -0.2014])\n\n\npos_weight ã¯ å„ã‚¯ãƒ©ã‚¹ã§ Positive/Negative ã®ãƒ‡ãƒ¼ã‚¿æ•°ãŒä¸å‡è¡¡ãªå ´åˆã«è¨­å®šã™ã‚‹ã¨è‰¯ã„ã‚‰ã—ã„\n\n\n\nCopyrightCopyright tamuraup. 2024. All Rights Reserved"
  },
  {
    "objectID": "posts/2025-07-01_soutui.html",
    "href": "posts/2025-07-01_soutui.html",
    "title": "ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ§‹é€ ã¨ç›¸è£œæ€§æ¡ä»¶ã®ç†è§£",
    "section": "",
    "text": "Note\n\n\n\nã“ã®ãƒ¬ãƒãƒ¼ãƒˆã¯ OpenAI ã® ChatGPT ã«ã‚ˆã£ã¦è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚"
  },
  {
    "objectID": "posts/2025-07-01_soutui.html#åŒå¯¾å•é¡Œã®å®šç¾©ã¨æ„ç¾©",
    "href": "posts/2025-07-01_soutui.html#åŒå¯¾å•é¡Œã®å®šç¾©ã¨æ„ç¾©",
    "title": "ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ§‹é€ ã¨ç›¸è£œæ€§æ¡ä»¶ã®ç†è§£",
    "section": "1. åŒå¯¾å•é¡Œã®å®šç¾©ã¨æ„ç¾©",
    "text": "1. åŒå¯¾å•é¡Œã®å®šç¾©ã¨æ„ç¾©\nç·šå½¢è¨ˆç”»æ³•ã§ã¯ã€ä»»æ„ã®ä¸»å•é¡Œï¼ˆprimal problemï¼‰ã«å¯¾ã—ã¦ã€å¯¾å¿œã™ã‚‹åŒå¯¾å•é¡Œï¼ˆdual problemï¼‰ã‚’å®šå¼åŒ–ã§ãã¾ã™ã€‚åŒå¯¾å•é¡Œã‚’è€ƒãˆã‚‹æ„ç¾©ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š\n\nä¸»å•é¡Œã®æœ€é©å€¤ã«å¯¾ã™ã‚‹ä¸Šç•Œ/ä¸‹ç•Œã‚’æä¾›\nå•é¡Œã®æ§‹é€ ã®åˆ¥ã®è¦–ç‚¹ã‹ã‚‰ã®ç†è§£ã‚’å¯èƒ½ã«ã™ã‚‹\næ„Ÿåº¦åˆ†æã‚„ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ç·©å’Œã¨ã®æ¥ç¶šç‚¹ã«ãªã‚‹\nåŒå¯¾å•é¡Œã®ã»ã†ãŒè§£ãã‚„ã™ã„å ´åˆã‚‚ã‚ã‚‹"
  },
  {
    "objectID": "posts/2025-07-01_soutui.html#è£½é€ è¨ˆç”»ã®ä¾‹é¡Œ",
    "href": "posts/2025-07-01_soutui.html#è£½é€ è¨ˆç”»ã®ä¾‹é¡Œ",
    "title": "ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ§‹é€ ã¨ç›¸è£œæ€§æ¡ä»¶ã®ç†è§£",
    "section": "2. è£½é€ è¨ˆç”»ã®ä¾‹é¡Œ",
    "text": "2. è£½é€ è¨ˆç”»ã®ä¾‹é¡Œ\n\nğŸ“˜ ä¸»å•é¡Œï¼ˆè£½é€ è€…ã®è¦–ç‚¹ï¼‰\nè£½å“ Aãƒ»B ã‚’è£½é€ ã™ã‚‹å·¥å ´ãŒã‚ã‚Šã€ãã‚Œãã‚Œã«ä½œæ¥­æ™‚é–“ã¨ææ–™ãŒå¿…è¦ã€‚ç›®çš„ã¯åˆ©ç›Šã®æœ€å¤§åŒ–ã€‚\n\\[\n\\begin{align*}\n\\text{maximize} \\quad & 3x_1 + 2x_2 \\\\\n\\text{subject to} \\quad\n& x_1 + x_2 \\le 4 \\quad \\text{(ä½œæ¥­æ™‚é–“ï¼šæœ€å¤§4æ™‚é–“)} \\\\\n& 2x_1 + x_2 \\le 5 \\quad \\text{(ææ–™ï¼šæœ€å¤§5kg)} \\\\\n& x_1 \\ge 0,\\quad x_2 \\ge 0\n\\end{align*}\n\\]\n\n\\(x_1\\)ï¼šè£½å“ A ã®ç”Ÿç”£æ•°\n\\(x_2\\)ï¼šè£½å“ B ã®ç”Ÿç”£æ•°\nåˆ©ç›Šï¼šè£½å“ A ã¯ 3 ä¸‡å††ã€è£½å“ B ã¯ 2 ä¸‡å††\n\n\n\nğŸ“— åŒå¯¾å•é¡Œï¼ˆè³‡æºã®ä¾¡å€¤è©•ä¾¡ï¼‰\nè³‡æº 1ï¼ˆä½œæ¥­æ™‚é–“ï¼‰ã€è³‡æº 2ï¼ˆææ–™ï¼‰ã«å¯¾ã—ã¦ã€ãã‚Œãã‚Œå®Ÿéš›ã®ã€Œä¾¡å€¤ã€ï¼ˆä¾¡æ ¼ï¼‰ã‚’å¤‰æ•° $y_1$, $y_2$ ã¨ã—ã¦è¨­å®šã—ã¾ã™ã€‚ ã“ã®ä¾¡å€¤ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€è£½é€ è€…ãŒè£½å“ 1 å˜ä½ã‚’ç”Ÿç”£ã™ã‚‹éš›ã«ã‹ã‹ã‚‹è³‡æºã‚³ã‚¹ãƒˆãŒã€ãã®è£½å“ã®å˜ä½åˆ©ç›Šã‚’ä¸‹å›ã‚‰ãªã„ã‚ˆã†ã«åˆ¶ç´„ã‚’èª²ã—ã¾ã™ã€‚\nåŒå¯¾å•é¡Œã®ç›®çš„ã¯ã€ã“ã†ã—ã¦è¨­å®šã—ãŸè³‡æºã®ä¾¡æ ¼ç·é¡ $4y_1 + 5y_2$ ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã§ã™ã€‚\n\\[\n\\begin{aligned}\n\\text{minimize} \\quad & 4y_1 + 5y_2 \\\\\\\\\n\\text{subject to} \\quad\n& y_1 + 2y_2 \\ge 3 \\quad \\text{(è£½å“A ã®å˜ä½åˆ©ç›Š 3 ä¸‡å††ã‚’è³„ã†ã‚³ã‚¹ãƒˆ)} \\\\\\\\\n& y_1 + y_2 \\ge 2 \\quad \\text{(è£½å“B ã®å˜ä½åˆ©ç›Š 2 ä¸‡å††ã‚’è³„ã†ã‚³ã‚¹ãƒˆ)} \\\\\\\\\n& y_1 \\ge 0, \\quad y_2 \\ge 0\n\\end{aligned}\n\\]\n\nã“ã®å•é¡Œã§ã¯ã€è³‡æºã«ä¾¡æ ¼ã‚’ä¸ãˆã‚‹ã“ã¨ã§ã€Œè£½å“ 1 å˜ä½ã‚’ç”Ÿç”£ã™ã‚‹ãŸã‚ã«å¿…è¦ãªè³‡æºã‚³ã‚¹ãƒˆã€ãŒç®—å‡ºã•ã‚Œã¾ã™ã€‚ å„è£½å“ã®åˆ©ç›Šã‚’ä¸‹å›ã‚‰ãªã„ã‚ˆã†ã«ã‚³ã‚¹ãƒˆã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€è³‡æºã®ä¾¡å€¤ã‚’é©åˆ‡ã«è©•ä¾¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nä¸€æ–¹ã§ã€è³‡æºã®ä¾¡æ ¼ç·é¡ã¯ã§ãã‚‹ã ã‘å°ã•ãæŠ‘ãˆã‚‹ã“ã¨ãŒç›®çš„ã¨ãªã£ã¦ã„ã¾ã™ã€‚ ã“ã®ã‚ˆã†ã«ã€è£½å“ã®ä¾¡å€¤ã«è¦‹åˆã†ã‚ˆã†ã«è³‡æºä¾¡æ ¼ã‚’ä¿ã¡ã¤ã¤ã€ãã®åˆè¨ˆã‚’æœ€å°ã«ã™ã‚‹ã¨ã„ã†è¦è«‹ãŒä¸¡ç«‹ã™ã‚‹ã‚ˆã†ã«ã€è³‡æºã®ä¾¡æ ¼ã¯èª¿æ•´ã•ã‚Œã¾ã™ã€‚"
  },
  {
    "objectID": "posts/2025-07-01_soutui.html#åŒå¯¾å•é¡Œã®è¤‡æ•°ã®è§£é‡ˆ",
    "href": "posts/2025-07-01_soutui.html#åŒå¯¾å•é¡Œã®è¤‡æ•°ã®è§£é‡ˆ",
    "title": "ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ§‹é€ ã¨ç›¸è£œæ€§æ¡ä»¶ã®ç†è§£",
    "section": "3. åŒå¯¾å•é¡Œã®è¤‡æ•°ã®è§£é‡ˆ",
    "text": "3. åŒå¯¾å•é¡Œã®è¤‡æ•°ã®è§£é‡ˆ\n\n\n\n\n\n\n\n\nè§£é‡ˆã®ã‚¿ã‚¤ãƒ—\nå†…å®¹\né©ã—ãŸå¿œç”¨åˆ†é‡\n\n\n\n\nè³‡æºä¾¡æ ¼\nåˆ¶ç´„ã”ã¨ã«å˜ä½ä¾¡å€¤ï¼ˆå½±ã®ä¾¡æ ¼ï¼‰ã‚’ã¤ã‘ã‚‹\nçµŒæ¸ˆå­¦ã€çµŒå–¶å­¦\n\n\næ„Ÿåº¦åˆ†æ\nåˆ¶ç´„ã®å³è¾ºãŒå¤‰å‹•ã—ãŸã¨ãã®æœ€é©å€¤ã®å¤‰åŒ–ç‡\nå®Ÿå‹™æœ€é©åŒ–\n\n\nã‚²ãƒ¼ãƒ ç†è«–\nä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã¯ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã®é§†ã‘å¼•ã\nç†è«–è§£æã€ãƒŠãƒƒã‚·ãƒ¥å‡è¡¡\n\n\nä»£æ›¿ã‚³ã‚¹ãƒˆ\nåˆ¶ç´„ã‚’ç·©å’Œã™ã‚‹ãŸã‚ã®ä»£æ›¿æ‰‹æ®µã®è©•ä¾¡\nå·¥å­¦çš„è¨­è¨ˆã€ç‰©æµ"
  },
  {
    "objectID": "posts/2025-07-01_soutui.html#ç›¸è£œæ€§æ¡ä»¶ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ¥ç¶š",
    "href": "posts/2025-07-01_soutui.html#ç›¸è£œæ€§æ¡ä»¶ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ¥ç¶š",
    "title": "ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ§‹é€ ã¨ç›¸è£œæ€§æ¡ä»¶ã®ç†è§£",
    "section": "4. ç›¸è£œæ€§æ¡ä»¶ï¼šä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ¥ç¶š",
    "text": "4. ç›¸è£œæ€§æ¡ä»¶ï¼šä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ¥ç¶š\nä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æœ€é©è§£ãŒã¨ã‚‚ã«å­˜åœ¨ã™ã‚‹ã¨ãã€ä¸¡è€…ã®é–“ã«ã¯ç›¸è£œæ€§æ¡ä»¶ãŒæˆç«‹ã—ã¾ã™ã€‚\n\nç­‰å¼ã«ã‚ˆã‚‹è¡¨ç¾ï¼ˆã“ã®ä¾‹ã«ãŠã‘ã‚‹ç›¸è£œæ€§ï¼‰\n\\[\n\\begin{cases}\n(4 - x_1 - x_2) \\cdot y_1 = 0 \\\\\n(5 - 2x_1 - x_2) \\cdot y_2 = 0 \\\\\n(y_1 + 2y_2 - 3) \\cdot x_1 = 0 \\\\\n(y_1 + y_2 - 2) \\cdot x_2 = 0\n\\end{cases}\n\\]\n\nä¸»å•é¡Œã®åˆ¶ç´„ãŒä½™ã£ã¦ã„ã‚Œã°ï¼ˆã‚¹ãƒ©ãƒƒã‚¯ &gt; 0ï¼‰ â†’ å¯¾å¿œã™ã‚‹åŒå¯¾å¤‰æ•°ã¯ 0\nä¸»å•é¡Œã®åˆ¶ç´„ãŒãƒ”ãƒƒã‚¿ãƒªå¼µã£ã¦ã„ã‚Œã° â†’ åŒå¯¾å¤‰æ•°ã¯æ­£\nä¸»å•é¡Œã®å¤‰æ•°ãŒæ­£ãªã‚‰ â†’ åŒå¯¾åˆ¶ç´„ã¯ã‚®ãƒªã‚®ãƒªæº€ãŸã•ã‚Œã¦ã„ã‚‹ï¼ˆï¼å·ï¼‰\nä¸»å•é¡Œã®å¤‰æ•°ãŒã‚¼ãƒ­ãªã‚‰ â†’ åŒå¯¾åˆ¶ç´„ã¯ç·©ã‚“ã§ã„ã‚‹ï¼ˆï¼ï¼‰"
  },
  {
    "objectID": "posts/2025-07-01_soutui.html#ç›´æ„Ÿçš„è§£é‡ˆã®è£œè¶³",
    "href": "posts/2025-07-01_soutui.html#ç›´æ„Ÿçš„è§£é‡ˆã®è£œè¶³",
    "title": "ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ§‹é€ ã¨ç›¸è£œæ€§æ¡ä»¶ã®ç†è§£",
    "section": "5. ç›´æ„Ÿçš„è§£é‡ˆã®è£œè¶³",
    "text": "5. ç›´æ„Ÿçš„è§£é‡ˆã®è£œè¶³\nãŸã¨ãˆã°ã€åŒå¯¾åˆ¶ç´„ \\(y_1 + 2y_2 \\ge 3\\) ãŒå³ã—ãã¦ã€å®Ÿéš›ã«\n\\[\ny_1 + 2y_2 &gt; 3\n\\]\nã ã£ãŸå ´åˆã€ä¸»å•é¡Œå´ã§ã¯ã“ã†è€ƒãˆã‚‹ï¼š\n\nã€Œã“ã®è³‡æºä¾¡æ ¼ã§è£½å“ A ã‚’ä½œã‚‹ã¨æã«ãªã‚‹ã€‚ãªã‚‰ã°ä½œã‚‰ãªã„ï¼ˆ\\(x_1 = 0\\)ï¼‰ï¼ã€\n\né€†ã«ã€ã‚‚ã— \\(x_1 &gt; 0\\) ã§è£½å“ A ã‚’å®Ÿéš›ã«ä½œã£ã¦ã„ãŸãªã‚‰ã€\n\\[\ny_1 + 2y_2 = 3\n\\]\nã§ãªã‘ã‚Œã°ç›¸è£œæ€§æ¡ä»¶ãŒç ´ã‚Œã‚‹ã€‚"
  },
  {
    "objectID": "posts/2025-07-01_soutui.html#ç›¸è£œæ€§æ¡ä»¶ã®ã¾ã¨ã‚è¡¨",
    "href": "posts/2025-07-01_soutui.html#ç›¸è£œæ€§æ¡ä»¶ã®ã¾ã¨ã‚è¡¨",
    "title": "ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ§‹é€ ã¨ç›¸è£œæ€§æ¡ä»¶ã®ç†è§£",
    "section": "6. ç›¸è£œæ€§æ¡ä»¶ã®ã¾ã¨ã‚è¡¨",
    "text": "6. ç›¸è£œæ€§æ¡ä»¶ã®ã¾ã¨ã‚è¡¨\n\n\n\n\n\n\n\n\nçŠ¶æ³\nçµæœ\nè§£é‡ˆ\n\n\n\n\nåŒå¯¾åˆ¶ç´„ãŒ ç·©ã„ï¼ˆ&gt;ï¼‰\n\\(x_i = 0\\)\nã‚³ã‚¹ãƒˆé«˜ã™ãã€ä½œã‚‰ãªã„\n\n\nåŒå¯¾åˆ¶ç´„ãŒ ç­‰å·ï¼ˆ=ï¼‰\n\\(x_i &gt; 0\\)\nã¡ã‚‡ã†ã©é‡£ã‚Šåˆã£ã¦ã‚‹ã‹ã‚‰ä½œã‚‹\n\n\nä¸»å•é¡Œã®åˆ¶ç´„ãŒ ç·©ã„ï¼ˆ&lt;ï¼‰\n\\(y_j = 0\\)\nä½™ã£ã¦ã‚‹è³‡æºã¯ä¾¡å€¤ãŒãªã„\n\n\nä¸»å•é¡Œã®åˆ¶ç´„ãŒ ç­‰å·ï¼ˆ=ï¼‰\n\\(y_j &gt; 0\\)\nã‚®ãƒªã‚®ãƒªã®è³‡æºã¯ä¾¡å€¤ãŒã‚ã‚‹"
  },
  {
    "objectID": "posts/2025-07-01_soutui.html#ãŠã‚ã‚Šã«",
    "href": "posts/2025-07-01_soutui.html#ãŠã‚ã‚Šã«",
    "title": "ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ§‹é€ ã¨ç›¸è£œæ€§æ¡ä»¶ã®ç†è§£",
    "section": "ãŠã‚ã‚Šã«",
    "text": "ãŠã‚ã‚Šã«\nåŒå¯¾å•é¡Œã¨ç›¸è£œæ€§æ¡ä»¶ã¯ã€ç·šå½¢è¨ˆç”»ã«ãŠã‘ã‚‹æ§‹é€ çš„ç†è§£ã®ã‚«ã‚®ã¨ãªã‚‹æ¦‚å¿µã§ã™ã€‚ç‰¹ã«ã€ä¸»å•é¡Œã®åˆ¶ç´„ã¨åŒå¯¾å¤‰æ•°ã€ç›®çš„é–¢æ•°ã¨åˆ¶ç´„ã®ç·Šå¼µé–¢ä¿‚ã‚’æŠŠæ¡ã™ã‚‹ã“ã¨ã§ã€æ•°å¼ã®è£ã«ã‚ã‚‹çµŒæ¸ˆçš„ãƒ»æ§‹é€ çš„æ„å‘³ã‚’èª­ã¿å–ã‚‹åŠ›ãŒé¤Šã‚ã‚Œã¾ã™ã€‚\nå®Ÿå‹™ã‚„ç†è«–ã®ä¸¡é¢ã§æ´»ç”¨ã•ã‚Œã‚‹ã“ã®çŸ¥è­˜ã¯ã€æœ€é©åŒ–ã®å¿œç”¨ã‚„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è¨­è¨ˆã«ã‚‚ã¤ãªãŒã‚Šã¾ã™ã€‚ã•ã‚‰ãªã‚‹ç†è§£ã®ãŸã‚ã«ã¯ã€ä»–ã®å•é¡Œè¨­å®šã§ã®åŒå¯¾å•é¡Œã¨ç›¸è£œæ€§æ¡ä»¶ã®æ¼”ç¿’ã‚‚æœ‰åŠ¹ã§ã™ã€‚"
  },
  {
    "objectID": "archives/2024-05-20_compute_delta.html",
    "href": "archives/2024-05-20_compute_delta.html",
    "title": "éŸ³å£°ä¿¡å·ã® â€œdeltaâ€ ã¨ã„ã†ç‰¹å¾´é‡",
    "section": "",
    "text": "éŸ³å£°ä¿¡å·ã« delta ã¨ã„ã†ç‰¹å¾´é‡ãŒã‚ã‚‹ã‚‰ã—ã„ã€‚ Practical Cryptography\nã‚ã¾ã‚Šè‰¯ãã‚ã‹ã£ã¦ã„ã¾ã›ã‚“ãŒã€å„å‘¨æ³¢æ•°å¸¯ã§ã®è»Œè·¡ã‚’ç‰¹å¾´é‡ã«ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã—ã‚‡ã†ã‹ï¼Ÿ å„å‘¨æ³¢æ•°å¸¯ã®ãƒ‡ãƒ¼ã‚¿ã¨ [1.0] * time ã‚’ãŸãŸã¿è¾¼ã¿æ¼”ç®—ã‚’ã—ãŸã‚‚ã®ç‰¹å¾´é‡ã¨ã™ã‚‹ã‚ˆã†ã§ã™ã€‚\nkaggle ã§ã‚‚éå»ã®ä¸Šä½è§£æ³•ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚[4-th place solution] Inference and Training tips\nã¾ãŸ torchaudio ã«ã‚‚å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚torchaudio.functional.compute_deltas â€” Torchaudio 2.2.0.dev20240520 documentation\nå®Ÿè£…ä¾‹"
  },
  {
    "objectID": "archives/2024-05-20_compute_delta.html#ä¸€å¿œæ¼”ç®—çµæœç¢ºèªã—ã¦ãŠã",
    "href": "archives/2024-05-20_compute_delta.html#ä¸€å¿œæ¼”ç®—çµæœç¢ºèªã—ã¦ãŠã",
    "title": "éŸ³å£°ä¿¡å·ã® â€œdeltaâ€ ã¨ã„ã†ç‰¹å¾´é‡",
    "section": "ä¸€å¿œæ¼”ç®—çµæœç¢ºèªã—ã¦ãŠã",
    "text": "ä¸€å¿œæ¼”ç®—çµæœç¢ºèªã—ã¦ãŠã\n\nimport numpy as np\nimport torch\n\n\n# kaggle ã® solution notebook ã‚ˆã‚Š\ndef compute_deltas(\n        specgram: torch.Tensor, win_length: int = 5, mode: str = \"replicate\"\n) -&gt; torch.Tensor:\n    device = specgram.device\n    dtype = specgram.dtype\n\n    # pack batch\n    shape = specgram.size()\n    specgram = specgram.reshape(1, -1, shape[-1])\n\n    assert win_length &gt;= 3\n\n    n = (win_length - 1) // 2\n\n    # twice sum of integer squared\n    denom = n * (n + 1) * (2 * n + 1) / 3\n\n    specgram = torch.nn.functional.pad(specgram, (n, n), mode=mode)\n\n    kernel = torch.arange(-n, n + 1, 1, device=device, dtype=dtype).repeat(\n        specgram.shape[1], 1, 1\n    )\n    output = (\n            torch.nn.functional.conv1d(specgram, kernel, groups=specgram.shape[1]) / denom\n    )\n\n    # unpack batch\n    output = output.reshape(shape)\n\n    return output\n\n\nx=torch.rand([1, 10]) # dim (freq, time)\nprint(x.shape)\nprint(x)\n\ntorch.Size([1, 10])\ntensor([[0.6760, 0.4193, 0.8303, 0.1316, 0.1804, 0.4828, 0.7212, 0.0631, 0.1529,\n         0.5410]])\n\n\n\ndelta=compute_deltas(x)\nprint(delta.shape)\nprint(delta)\n\ntorch.Size([1, 10])\ntensor([[ 0.0052, -0.0934, -0.1279, -0.0523,  0.0133,  0.0404, -0.0475, -0.0452,\n          0.0117,  0.1344]])\n\n\n\nn=2\ntmp=torch.nn.functional.pad(x, (2, 2), mode='replicate')\ndenom = n * (n + 1) * (2 * n + 1) / 3\n\n\nfor p in range(n,n+10):\n    sm=0.0\n    for i in range(1,n+1):\n        sm+=(-tmp[0][p-i] +tmp[0][p+i])*i\n    print(sm/denom)\n\ntensor(0.0052)\ntensor(-0.0934)\ntensor(-0.1279)\ntensor(-0.0523)\ntensor(0.0133)\ntensor(0.0404)\ntensor(-0.0475)\ntensor(-0.0452)\ntensor(0.0117)\ntensor(0.1344)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ã‚ã‚‚ã¡ã‚‡ã†",
    "section": "",
    "text": "ä¸»å•é¡Œã¨åŒå¯¾å•é¡Œã®æ§‹é€ ã¨ç›¸è£œæ€§æ¡ä»¶ã®ç†è§£\n\n\n\nç·šå½¢è¨ˆç”»æ³•\n\næ•°ç†æœ€é©åŒ–\n\n\n\n\n\n\n\n\n\n2025 å¹´ 07 æœˆ 01 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nçµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-2\n\n\n\nçµ±è¨ˆå…¥é–€\n\næ™‚ç³»åˆ—åˆ†æ\n\n\n\n\n\n\n\n\n\n2025 å¹´ 06 æœˆ 30 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nçµ±è¨ˆå…¥é–€27. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åˆ†æ-1\n\n\n\nçµ±è¨ˆå…¥é–€\n\næ™‚ç³»åˆ—åˆ†æ\n\n\n\n\n\n\n\n\n\n2025 å¹´ 06 æœˆ 29 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nAUCLoss ã«é–¢ã™ã‚‹è§£èª¬ãƒ¬ãƒãƒ¼ãƒˆ\n\n\n\nML\n\n\n\n\n\n\n\n\n\n2025 å¹´ 06 æœˆ 15 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nã‚¢ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚° + ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°å‡¦ç†ã®æµã‚Œ\n\n\n\nML\n\n\n\n\n\n\n\n\n\n2025 å¹´ 06 æœˆ 15 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nPython ã§ã‚¹ã‚­ãƒ£ãƒ³ç”»åƒã®å›è»¢è£œæ­£ã‚’ã‚„ã£ã¦ã¿ã‚‹\n\n\n\nPython\n\nimage\n\n\n\n\n\n\n\n\n\n2025 å¹´ 03 æœˆ 25 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\næ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã® lag, step ã®ä½œæˆæ“ä½œ\n\n\n\nml\n\n\n\n\n\n\n\n\n\n2025 å¹´ 02 æœˆ 05 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nRust WebAssembly + React (Vite) ã§ä½œæˆã—ãŸã‚µã‚¤ãƒˆã‚’ GitLab Pages ã¸ãƒ‡ãƒ—ãƒ­ã‚¤\n\n\n\nGitLab\n\nRust\n\nwasm\n\n\n\n\n\n\n\n\n\n2024 å¹´ 09 æœˆ 17 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ 3ç«  ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å®š\n\n\n\nml\n\n\n\n\n\n\n\n\n\n2024 å¹´ 08 æœˆ 16 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nãƒ‡ãƒ¼ã‚¿è§£æã®ãŸã‚ã®çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å…¥é–€ 3ç« ã®ãƒã‚¢ã‚½ãƒ³å›å¸°\n\n\n\nml\n\n\n\n\n\n\n\n\n\n2024 å¹´ 08 æœˆ 16 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nã‚¬ã‚¦ã‚¹éç¨‹ã¨æ©Ÿæ¢°å­¦ç¿’ 3ç«  ã‚¬ã‚¦ã‚¹éç¨‹å›å¸°\n\n\n\nml\n\nnotebook\n\n\n\n\n\n\n\n\n\n2024 å¹´ 08 æœˆ 14 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nSQLã‚³ãƒ³ãƒ†ã‚¹ãƒˆã®å•é¡Œ 4 ã‚’è§£ã(ç¬¬ 1ã€œ10 å›)\n\n\n\nSQL\n\n\n\n\n\n\n\n\n\n2024 å¹´ 06 æœˆ 17 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nAHC028 è§£èª¬æ”¾é€ãƒ¡ãƒ¢\n\n\n\nahc\n\n\n\n\n\n\n\n\n\n2024 å¹´ 06 æœˆ 07 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nnumpy, pandas.DataFrame ã§å¤šæ•°æ±ºã‚’ã¨ã‚‹\n\n\n\nml\n\n\n\n\n\n\n\n\n\n2024 å¹´ 05 æœˆ 12 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nPyTorch å­¦ç¿’çµæœã®å†ç¾æ€§ç¢ºä¿\n\n\n\nml\n\n\n\n\n\n\n\n\n\n2024 å¹´ 05 æœˆ 11 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nBCEWithLogitsLoss ã®ç¢ºèª\n\n\n\nml\n\n\n\n\n\n\n\n\n\n2024 å¹´ 05 æœˆ 09 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nç”»åƒã‚°ãƒªãƒƒãƒ‰æç”»ã‚µãƒ³ãƒ—ãƒ«\n\n\n\nnotebook\n\nimage\n\n\n\n\n\n\n\n\n\n2024 å¹´ 05 æœˆ 04 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\nAHC032 è§£èª¬æ”¾é€ãƒ¡ãƒ¢\n\n\n\nahc\n\n\n\n\n\n\n\n\n\n2024 å¹´ 05 æœˆ 03 æ—¥\n\n\n\n\n\n\n\n\n\n\n\n\ngpu check\n\n\n\nnotebook\n\n\n\n\n\n\n\n\n\n2024 å¹´ 05 æœˆ 01 æ—¥\n\n\n\n\n\nNo matching items\nCopyrightCopyright tamuraup. 2024. All Rights Reserved"
  }
]