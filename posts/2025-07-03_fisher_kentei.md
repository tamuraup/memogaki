---
title: 統計入門28. フィッシャーの正確検定と超幾何分布の理解
date: 2025-07-03
categories: [統計入門, フィッシャーの正確検定]
---

::: {.callout-note}
**このレポートは OpenAI の ChatGPT によって自動生成されました。**
:::

## 概要

このドキュメントでは、フィッシャーの正確検定（Fisher's exact test）について、その**数式的背景**、**超幾何分布との関係**、および**オッズ比の片側検定**への応用までを丁寧に解説しています。特に小標本におけるカテゴリカルデータの解析に適しており、正確な $p$ 値を求められる点が特徴です。

---

## フィッシャーの正確検定とは

フィッシャーの正確検定は、2×2 のクロス表において、**行と列の間に有意な関係があるか**を評価するための検定方法です。サンプル数が小さい場合でも正確な結果が得られるため、**カイ二乗検定の代替手段**として利用されます。

### 2×2 表の一般形

$$
\begin{array}{c|cc|c}
 & \text{列1} & \text{列2} & \text{行合計} \\
\hline
\text{行1} & a & b & a + b \\
\text{行2} & c & d & c + d \\
\hline
\text{列合計} & a + c & b + d & n = a + b + c + d
\end{array}
$$

---

## 数式の成り立ち

フィッシャーの正確検定で用いる確率は、**周辺度数（行と列の合計）を固定**した上で、この表が観測される確率を**超幾何分布**に基づいて計算します。

### 確率の計算式

$$
P(a) = \frac{(a + b)! (c + d)! (a + c)! (b + d)!}{a! b! c! d! n!}
$$

または、超幾何分布としての形：

$$
P(a) = \frac{
\binom{a + c}{a} \binom{b + d}{b}
}{
\binom{n}{a + b}
}
$$

これは、「改善者があらかじめ $K = a + c$ 人いて、無作為に投薬群（サンプル） $n = a + b$ 人を選んだとき、その中にちょうど $a$ 人の改善者が含まれる確率」を求めている形です。

---

## 超幾何分布との対応

フィッシャーの正確検定は、以下の超幾何分布のパラメータ設定と一致します：

| 超幾何分布の記号 | 解釈                                             |
| ---------------- | ------------------------------------------------ |
| $N$              | 全体の人数 $= n$                                 |
| $K$              | 成功（改善者）の数 $= a + c$                     |
| $n$              | サンプル（投薬群）に割り当てられた人数 $= a + b$ |
| $k$              | 成功かつサンプル内の人数 $= a$                   |

帰無仮説 $H_0$ のもとでは、**改善と投薬は無関係**なので、改善者は投薬群・非投薬群に**無作為に割り当てられる**。よって、投薬群に含まれる改善者数は超幾何分布に従います。

---

## オッズ比の片側検定への応用

フィッシャーの正確検定は、**オッズ比に関する片側検定**としても使用可能です。

- 帰無仮説：オッズ比 $\theta = 1$
- 対立仮説（右側検定）：$\theta > 1$（薬の効果がある）
- 観測された改善者数 $a$ に対し、それ以上に「オッズ比が大きくなるような」表の確率をすべて合計して片側 $p$ 値を算出

---

## 手計算にやさしい例題

以下の簡単な 2×2 表を用いて、手計算で片側 $p$ 値を求めました。

|                    | 改善した | 改善しなかった | 合計 |
| ------------------ | -------- | -------------- | ---- |
| 新薬群（投薬あり） | 3        | 1              | 4    |
| プラセボ群         | 1        | 3              | 4    |
| 合計               | 4        | 4              | 8    |

このとき、観測値 $a = 3$ に対し：

$$
P(a = 3) = \frac{\binom{4}{3} \binom{4}{1}}{\binom{8}{4}} = \frac{16}{70} \approx 0.2286
$$

$$
P(a = 4) = \frac{\binom{4}{4} \binom{4}{0}}{\binom{8}{4}} = \frac{1}{70} \approx 0.0143
$$

$$
P(a \geq 3) = \frac{17}{70} \approx 0.243
$$

よって、片側検定（右側）の $p$ 値は約 0.243。これは有意水準 5% では**有意ではない**と判断されます。
