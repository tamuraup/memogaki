---
title: "統計入門27. 時系列データ分析-1"
date: 2025-06-29
category: "統計入門"
tags:
  - 時系列分析
  - 統計入門
---

※このレポートは OpenAI の ChatGPT によって自動生成されました。

---

## 1. 弱定常過程と強定常過程の違い

| 種類       | 定義                                                   | 特徴                                     |
| ---------- | ------------------------------------------------------ | ---------------------------------------- |
| **弱定常** | 平均・分散・共分散が時間によらず一定                   | 共分散が\*\*ラグ（時間差）\*\*のみに依存 |
| **強定常** | あらゆる時点の**同時分布**が、時刻のシフトに対して不変 | 分布の形が時間で変わらない必要あり       |

> ✅ ノイズの合成の分布が変わると、強定常にならない
> ✅ 正規分布ノイズなら、線形結合しても形が変わらず → 強定常に近い

---

## 2. ARMA と ARIMA の違い

| モデル             | 内容                           | 対象データ                           |
| ------------------ | ------------------------------ | ------------------------------------ |
| **ARMA(p, q)**     | 自己回帰 + 移動平均            | **定常データ**                       |
| **ARIMA(p, d, q)** | 差分 + ARMA（非定常 → 定常化） | **非定常データ**（トレンドなど含む） |

ARIMA は「**差分をとったデータに ARMA モデルを当てる**」と理解するとわかりやすい。

---

## 3. ディッキー・フラー検定と拡張 DF 検定

| 検定         | 説明                                         | 適用範囲                 |
| ------------ | -------------------------------------------- | ------------------------ |
| **DF 検定**  | 単純な AR(1)構造で単位根を検定               | 誤差が白色雑音のとき限定 |
| **ADF 検定** | ラグ付き差分項を追加し、誤差の自己相関も考慮 | 実務ではこちらが主流 ✅  |

> 単位根がある＝非定常。ADF は `statsmodels.adfuller()` などで実行可能。

---

## 4. MA(q)モデルの次数の決め方

- **自己相関関数（ACF）を使う**
- MA(q)の場合、\*\*ACF はラグ q で急にゼロ（打ち切り）\*\*になる

```text
例：ACFがラグ2でパタッとゼロ → MA(2)モデルの候補
```

---

## 5. 自己相関係数は何に対して計算する？

> ✅ ACF は「**実際の時系列データ**」に対して計算
> → 各ラグにおいて、データがどれだけ自分と似ているか（自己相関）を測る

---

## 6. AR モデルの次数の決め方：PACF を使う

| モデル | 判断に使う             | 打ち切れる箇所 |
| ------ | ---------------------- | -------------- |
| AR(p)  | **PACF**（偏自己相関） | ラグ p         |
| MA(q)  | **ACF**（自己相関）    | ラグ q         |

- PACF がラグ 2 まで非ゼロ → AR(2)の候補
- ACF/PACF は **モデル構造のヒント**であり、最終的には **AIC/BIC などで比較**

---

## 7. AR と ARMA、どちらを使うか？

| ACF      | PACF     | 推奨モデル |
| -------- | -------- | ---------- |
| 減衰     | 打ち切り | AR(p)      |
| 打ち切り | 減衰     | MA(q)      |
| 減衰     | 減衰     | ARMA(p, q) |

- 実務では AR だけで足りない場合も多く、**ARMA がより柔軟で使われやすい**
- モデルは **ACF/PACF で仮説を立て、AIC/BIC で確定**が王道

---
