---
title: 統計入門27. 時系列データ分析
date: 2025-06-30
categories: [統計入門, 時系列分析]
---

::: {.callout-note}
**本レポートは、OpenAI の対話型 AI ChatGPT により生成・整理されたものです。**
:::

## 1. スペクトル密度関数とペリオドグラム

- **スペクトル密度関数**は、時系列データの各周波数成分の強さ（エネルギー）を表す関数。定常な過程に対して定義される。
- 角周波数は通常 \( \omega \in [-\pi, \pi] \) で表す。
- **ペリオドグラム**は、スペクトル密度の推定量の一つ：
  - 観測データのフーリエ変換の絶対値平方で定義。
  - **一致推定量ではない**（分散が消えず収束しない）ため、そのままでは不安定。
  - 対応策として Welch 法、AR モデル推定、カーネル平滑などがある。

## 2. 状態空間モデルの構造

- **状態空間モデル（State Space Model）**は観測されない状態変数 \( x_t \) を導入し、観測データ \( y_t \) をその関数として記述する。
- 2 本の方程式で構成される：

### 状態方程式（state equation）

\[
x*t = F x*{t-1} + w_t, \quad w_t \sim \mathcal{N}(0, Q)
\]

### 観測方程式（observation equation）

\[
y_t = H x_t + v_t, \quad v_t \sim \mathcal{N}(0, R)
\]

- \( x_t \) は観測されないが、時系列的に推移する。
- \( y_t \) は \( x_t \) を通じて得られる観測量。

## 3. カルマンフィルタの仕組み

- **カルマンフィルタ**は、状態空間モデルの中で隠れた状態 \( x_t \) を逐次的に推定するアルゴリズム。
- 処理は 2 段階：

### 予測（predict）

\[
\hat{x}_{t|t-1} = F \hat{x}_{t-1|t-1}, \quad
P*{t|t-1} = F P*{t-1|t-1} F^\top + Q
\]

### 更新（update）

\[
K*t = P*{t|t-1} H^\top (H P*{t|t-1} H^\top + R)^{-1}
\]
\[
\hat{x}*{t|t} = \hat{x}_{t|t-1} + K_t (y_t - H \hat{x}_{t|t-1})
\]
\[
P*{t|t} = (I - K_t H) P*{t|t-1}
\]

- 状態 \( x_t \) は常に**観測されない**ため、予測 → 観測値で補正、という手順を踏む。
- このモデルの実用的な目的の一つは、**未来の観測値 \( y\_{t+1} \) の予測**。

## 4. ダービー・ワトソン検定

- 回帰分析の残差に**自己相関（特に 1 次）**があるかどうかを調べる検定。
- 検定統計量：

\[
DW = \frac{\sum*{t=2}^n (e_t - e*{t-1})^2}{\sum\_{t=1}^n e_t^2}
\]

- 解釈：
  - \( DW \approx 2 \)：自己相関なし
  - \( DW < 2 \)：**正の自己相関**
  - \( DW > 2 \)：**負の自己相関**
- 回帰モデルの誤差項がホワイトノイズ（独立同分布）かどうかをチェックする一手段。

## 5. AIC（赤池情報量規準）

### 式

\[
\mathrm{AIC} = -2 \log L + 2k
\]

- \( L \)：最尤推定による最大尤度
- \( k \)：推定パラメータ数

### 意味

- モデルの「当てはまりの良さ（尤度）」と「複雑さ（自由度）」のバランスをとる指標。
- **AIC が小さいほど良いモデル**（汎化性能が高いとみなされる）。
