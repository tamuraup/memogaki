---
title: 主問題と双対問題の構造と相補性条件の理解
date: 2025-07-01
categories: [線形計画法, 数理最適化]
---

::: {.callout-note}
**このレポートは OpenAI の ChatGPT によって自動生成されました。**
:::

---

## 1. 双対問題の定義と意義

線形計画法では、任意の主問題（primal problem）に対して、対応する双対問題（dual problem）を定式化できます。双対問題を考える意義は以下の通りです：

- 主問題の最適値に対する**上界/下界**を提供
- 問題の構造の**別の視点からの理解**を可能にする
- 感度分析やラグランジュ緩和との接続点になる
- 双対問題のほうが解きやすい場合もある

## 2. 製造計画の例題

### 📘 主問題（製造者の視点）

製品 A・B を製造する工場があり、それぞれに作業時間と材料が必要。目的は利益の最大化。

$$
\begin{align*}
\text{maximize} \quad & 3x_1 + 2x_2 \\
\text{subject to} \quad
& x_1 + x_2 \le 4 \quad \text{(作業時間：最大4時間)} \\
& 2x_1 + x_2 \le 5 \quad \text{(材料：最大5kg)} \\
& x_1 \ge 0,\quad x_2 \ge 0
\end{align*}
$$

- $x_1$：製品 A の生産数
- $x_2$：製品 B の生産数
- 利益：製品 A は 3 万円、製品 B は 2 万円

### 📗 双対問題（資源の価値評価）

資源 1（作業時間）、資源 2（材料）に対して、それぞれ実際の「価値」（価格）を変数 \$y_1\$, \$y_2\$ として設定します。
この価値を用いることで、製造者が製品 1 単位を生産する際にかかる資源コストが、その製品の単位利益を下回らないように制約を課します。

双対問題の目的は、こうして設定した資源の価格総額 \$4y_1 + 5y_2\$ を最小化することです。

$$
\begin{aligned}
\text{minimize} \quad & 4y_1 + 5y_2 \\\\
\text{subject to} \quad
& y_1 + 2y_2 \ge 3 \quad \text{(製品A の単位利益 3 万円を賄うコスト)} \\\\
& y_1 + y_2 \ge 2 \quad \text{(製品B の単位利益 2 万円を賄うコスト)} \\\\
& y_1 \ge 0, \quad y_2 \ge 0
\end{aligned}
$$

---

この問題では、資源に価格を与えることで「製品 1 単位を生産するために必要な資源コスト」が算出されます。
各製品の利益を下回らないようにコストを設定することで、資源の価値を適切に評価することができます。

一方で、資源の価格総額はできるだけ小さく抑えることが目的となっています。
このように、製品の価値に見合うように資源価格を保ちつつ、その合計を最小にするという要請が両立するように、資源の価格は調整されます。

## 3. 双対問題の複数の解釈

| 解釈のタイプ   | 内容                                     | 適した応用分野         |
| -------------- | ---------------------------------------- | ---------------------- |
| **資源価格**   | 制約ごとに単位価値（影の価格）をつける   | 経済学、経営学         |
| **感度分析**   | 制約の右辺が変動したときの最適値の変化率 | 実務最適化             |
| **ゲーム理論** | 主問題と双対問題はプレイヤー間の駆け引き | 理論解析、ナッシュ均衡 |
| **代替コスト** | 制約を緩和するための代替手段の評価       | 工学的設計、物流       |

## 4. 相補性条件：主問題と双対問題の接続

主問題と双対問題の最適解がともに存在するとき、両者の間には**相補性条件**が成立します。

### 等式による表現（この例における相補性）

$$
\begin{cases}
(4 - x_1 - x_2) \cdot y_1 = 0 \\
(5 - 2x_1 - x_2) \cdot y_2 = 0 \\
(y_1 + 2y_2 - 3) \cdot x_1 = 0 \\
(y_1 + y_2 - 2) \cdot x_2 = 0
\end{cases}
$$

- 主問題の制約が**余っていれば**（スラック > 0） → 対応する双対変数は 0
- 主問題の制約が**ピッタリ張っていれば** → 双対変数は正
- 主問題の変数が正なら → 双対制約はギリギリ満たされている（＝号）
- 主問題の変数がゼロなら → 双対制約は緩んでいる（＞）

## 5. 直感的解釈の補足

たとえば、双対制約 $y_1 + 2y_2 \ge 3$ が厳しくて、実際に

$$
y_1 + 2y_2 > 3
$$

だった場合、主問題側ではこう考える：

> 「この資源価格で製品 A を作ると損になる。ならば作らない（$x_1 = 0$）！」

逆に、もし $x_1 > 0$ で製品 A を実際に作っていたなら、

$$
y_1 + 2y_2 = 3
$$

でなければ相補性条件が破れる。

## 6. 相補性条件のまとめ表

| 状況                         | 結果      | 解釈                         |
| ---------------------------- | --------- | ---------------------------- |
| 双対制約が **緩い（>）**     | $x_i = 0$ | コスト高すぎ、作らない       |
| 双対制約が **等号（=）**     | $x_i > 0$ | ちょうど釣り合ってるから作る |
| 主問題の制約が **緩い（<）** | $y_j = 0$ | 余ってる資源は価値がない     |
| 主問題の制約が **等号（=）** | $y_j > 0$ | ギリギリの資源は価値がある   |

## おわりに

双対問題と相補性条件は、線形計画における構造的理解のカギとなる概念です。特に、主問題の制約と双対変数、目的関数と制約の緊張関係を把握することで、数式の裏にある経済的・構造的意味を読み取る力が養われます。

実務や理論の両面で活用されるこの知識は、最適化の応用やアルゴリズム設計にもつながります。さらなる理解のためには、他の問題設定での双対問題と相補性条件の演習も有効です。
